# SDDMM_GPU 优化加速记录

---

## 加入 Tensor core

使用 Tensor core 直接对密集矩阵乘法进行计算, 计算时间

### 过程中发现的问题或优化点

#### 1:

函数 `__shfl_xor` 在 cuda 后续版本已经弃用, 应该改为使用 `__shfl_xor_sync`

但是发现使用 `__shfl_xor` 和 `__shfl_xor_sync` 的结果不一致

```c++
sm1 += __shfl_xor(sm1, 1); // 使用shuffle指令. 使线程0的sm1加到线程1的sm1上, 线程1的sm1加到线程2的sm2上
sm2 += __shfl_xor(sm2, 1);
```

```c++
sm1 += __shfl_xor_sync(0xFFFFFFFF, sm1, 1); // 使用shuffle指令. 使线程0的sm1加到线程1的sm1上, 线程1的sm1加到线程2的sm2上
sm2 += __shfl_xor_sync(0xFFFFFFFF, sm2, 1);
```

#### 2:

核函数中加入了 `if()` 判断语句, 就算永远执行单一分支也比不加入 `if()` 判断语句时耗时久

加入判断语句(用时: 31.388 ms):

```c++
const int ldp = N;
const auto pOffsetPtr = matrixP + pRowId * ldp + pColId;
const float sparsity = calculateMatrixTileSparsity(WMMA_M, WMMA_N, ldp, MatrixStorageOrder::row_major, pOffsetPtr);
if (sparsity < 0) { // Always false

} else {
matrixTileMultiplicationUseTensorCore(pRowId, pColId, M, N, K, matrixA, matrixB, matrixS, matrixP);
}
```

不加入判断语句(用时: 21.8441 ms):

```c++
const int ldp = N;
const auto pOffsetPtr = matrixP + pRowId * ldp + pColId;
const float sparsity = calculateMatrixTileSparsity(WMMA_M, WMMA_N, ldp, MatrixStorageOrder::row_major, pOffsetPtr);
//    if (sparsity < 0) { // Always false

//    } else {
matrixTileMultiplicationUseTensorCore(pRowId, pColId, M, N, K, matrixA, matrixB, matrixS, matrixP);
//    }
```

#### 3:

blockDim 的尺寸改变的话时间大幅度降低.

原来的尺寸是 `block.x = 32` `block.y = 32`

```
M : 37000, N : 37000, K : 256, nnz : 368000, sparsity : 99.9731%
openTensorCoreMode
openTensorCoreMode matrixA : row = 37008, col = 256
openTensorCoreMode matrixB : row = 256, col = 37008
openTensorCoreMode matrixS : row = 37008, col = 37008
grid : [2313 73 1] block : [32 32 1]
Func comp_sddmm_gpu time : 23.8314 ms
```

改成了 `block.x = 128` `block.y = 4`

```
M : 37000, N : 37000, K : 256, nnz : 368000, sparsity : 99.9731%
openTensorCoreMode
openTensorCoreMode matrixA : row = 37008, col = 256
openTensorCoreMode matrixB : row = 256, col = 37008
openTensorCoreMode matrixS : row = 37008, col = 37008
grid : [579 579 1] block : [128 4 1]
Func comp_sddmm_gpu time : 13.0769 ms
```

从 grid 的数量上看, 改成128和4时, grid 数量大大增加了, 原先 2313 × 73 = 168849, 变成 579 × 579 = 335241

#### 4: `print()`

在CPU中使用 `printf()` 函数会隐式转换, 而在GPU中使用 `printf()` 函数不会隐式转换, 需要显示转换. 例如:

```c++
    size_t numWarpX, numWarpY, numWarps;
printf(" numWarpX = %d, numWarpY = %d, numWarps = %d\n",
static_cast<int>(numWarpX), static_cast<int>(numWarpY), static_cast<int>(numWarps));
```

---

### 最初版本 测试结果

#### 测试结果 Debug build, 所有矩阵都是行主序储存

- GPU : 4090
- Debug build
- matrixA(half) : row_major, matrixB(half) : row_major, matrixP(float) : row_major
- WMMA : 16 × 16 × 16

| GPU : 4090, Debug build                                              | sddmm_isratnisa |  sddmm_zcx  |
|:---------------------------------------------------------------------|:---------------:|:-----------:|
| M : 1504, N : 1504, K : 256,<br/>nnz : 746316, sparsity : 67.0066%   |   2.13123 ms    | 0.059168 ms |
| M : 12432, N : 12432, K : 256,<br/>nnz : 746316, sparsity : 99.5171% |   0.419488 ms   | 3.06074 ms  |
| M : 8000, N : 8000, K : 256,<br/>nnz : 640000, sparsity : 99%        |   0.488832 ms   |  1.2759 ms  |
| M : 8000, N : 8000, K = 256,<br/>nnz: 1280000, sparsity : 98%        |   0.817376 ms   |    위에 같다    |
| M : 8000, N : 8000, K : 256,<br/>nnz : 1632000, sparsity : 97.45%    |   0.998016 ms   |    위에 같다    |
| M : 8000, N : 8000, K : 256,<br/>nnz : 1920000, sparsity : 97%       |   1.14563 ms    |    위에 같다    |
| M : 8000, N : 8000, K : 256,<br/>nnz : 2240000, sparsity : 96.5%     |   1.30128 ms    |    위에 같다    |
| M : 8000, N : 8000, K : 256,<br/> nnz : 2560000, sparsity : 96%      |   1.47882 ms    |    위에 같다    |
| M : 8000, N : 8000, K : 256,<br/>nnz : 6400000, sparsity : 90%       |   5.10989 ms    |    위에 같다    |

#### Release build

- Debug build
- GPU : 4090
- matrixA(half) : row_major, matrixB(half) : row_major, matrixP(float) : row_major

| 4090 |     |     |
|------|-----|-----|
|      |     |     |
|      |     |     |
|      |     |     |

---

### 使计算支持各个尺寸的矩阵(Matrix::openTensorCoreMode())

#### 测试结果 行主序储存 16×16×16

- GPU : 4090
- Debug build
- matrixA(half) : row_major, matrixB(half) : row_major, matrixP(float) : row_major
- WMMA : 16 × 16 × 16

| GPU:4090, debug build, row_major,16×16×16                            | sddmm_isratnisa | sddmm_zcx   |
|----------------------------------------------------------------------|-----------------|-------------|
| M : 3000, N : 7000, K : 256, nnz : 313110, sparsity : 98.51%         | 0.508448 ms     | 0.415744 ms |
| M : 2000, N : 12000, K : 256, nnz : 746000, sparsity : 96.8917%      | 1.59091 ms      | 0.448512 ms |
| M : 300000, N : 103000, K : 256, nnz : 69000000, sparsity : 99.7767% | 26.6559 ms      |             |
| M : 35000, N : 35000, K : 256, nnz : 422000, sparsity : 99.9656%     | 0.237888 ms     | 21.9749 ms  |
| M : 549000, N : 549000, K : 256, nnz : 926000, sparsity : 99.9997%   | 2.61411 ms      |             |
| M : 426000, N : 426000, K : 256, nnz : 1000000, sparsity : 99.9995%  | 2.41718 ms      |             |
| M : 37000, N : 37000, K : 256, nnz : 368000, sparsity : 99.9731%     | 0.234112 ms     | 23.9791 ms  |
| M : 4000, N : 4000, K : 256, nnz : 88000, sparsity : 99.45%          | 0.172064 ms     | 0.317472 ms |
| M : 106000, N : 106000, K : 256, nnz : 3000000, sparsity : 99.9733%  | 1.97805 ms      |             |
| M : 685000, N : 685000, K : 256, nnz : 8000000, sparsity : 99.9983%  | 12.3796 ms      |             |
| M : 916000, N : 916000, K : 256, nnz : 5000000, sparsity : 99.9994%  | 9.60342 ms      |             |
| M : 326000, N : 326000, K : 256, nnz : 1000000, sparsity : 99.9991%  | 2.11952 ms      |             |
| M : 197000, N : 197000, K : 256, nnz : 2000000, sparsity : 99.9948%  | 2.10243 ms      |             |
| M : 390000, N : 390000, K : 256, nnz : 2000000, sparsity : 99.9987%  | 3.45181 ms      |             |
| M : 260000, N : 260000, K : 256, nnz : 4000000, sparsity : 99.9941%  | 4.01792 ms      |             |
| M : 241000, N : 241000, K : 256, nnz : 561000, sparsity : 99.999%    | 1.28944 ms      |             |
| M : 36000, N : 36000, K : 256, nnz : 4000000, sparsity : 99.6914%    | 1.33123 ms      | 23.1115 ms  |

由于将稀疏矩阵按照0也储存的方式储存, 导致矩阵太大的情况下内存分配错误, 使得计算失败

#### 测试结果 行主序储存 32×8×16

- GPU : 4090
- Debug build
- matrixA(half) : row_major, matrixB(half) : row_major, matrixP(float) : row_major
- WMMA : 32×8×16

| GPU:4090, debug build, row_major, 32×8×16                            | sddmm_isratnisa | sddmm_zcx   |
|----------------------------------------------------------------------|-----------------|-------------|
| M : 3000, N : 7000, K : 256, nnz : 313110, sparsity : 98.51%         | 0.508448 ms     | 0.372704 ms |
| M : 2000, N : 12000, K : 256, nnz : 746000, sparsity : 96.8917%      | 1.59091 ms      | 0.44336 ms  |
| M : 300000, N : 103000, K : 256, nnz : 69000000, sparsity : 99.7767% | 26.6559 ms      |             |
| M : 35000, N : 35000, K : 256, nnz : 422000, sparsity : 99.9656%     | 0.237888 ms     | 17.8151 ms  |
| M : 549000, N : 549000, K : 256, nnz : 926000, sparsity : 99.9997%   | 2.61411 ms      |             |
| M : 426000, N : 426000, K : 256, nnz : 1000000, sparsity : 99.9995%  | 2.41718 ms      |             |
| M : 37000, N : 37000, K : 256, nnz : 368000, sparsity : 99.9731%     | 0.234112 ms     | 19.9316 ms  |
| M : 4000, N : 4000, K : 256, nnz : 88000, sparsity : 99.45%          | 0.172064 ms     | 0.317472 ms |
| M : 106000, N : 106000, K : 256, nnz : 3000000, sparsity : 99.9733%  | 1.97805 ms      |             |
| M : 685000, N : 685000, K : 256, nnz : 8000000, sparsity : 99.9983%  | 12.3796 ms      |             |
| M : 916000, N : 916000, K : 256, nnz : 5000000, sparsity : 99.9994%  | 9.60342 ms      |             |
| M : 326000, N : 326000, K : 256, nnz : 1000000, sparsity : 99.9991%  | 2.11952 ms      |             |
| M : 197000, N : 197000, K : 256, nnz : 2000000, sparsity : 99.9948%  | 2.10243 ms      |             |
| M : 390000, N : 390000, K : 256, nnz : 2000000, sparsity : 99.9987%  | 3.45181 ms      |             |
| M : 260000, N : 260000, K : 256, nnz : 4000000, sparsity : 99.9941%  | 4.01792 ms      |             |
| M : 241000, N : 241000, K : 256, nnz : 561000, sparsity : 99.999%    | 1.28944 ms      |             |
| M : 36000, N : 36000, K : 256, nnz : 4000000, sparsity : 99.6914%    | 1.33123 ms      | 19.9169 ms  |

由于将稀疏矩阵按照0也储存的方式储存, 导致矩阵太大的情况下内存分配错误, 使得计算失败

使用 32×8×16 的维度 比 16×16×16 更快了

#### 测试结果 行主序储存 8×32×16

- GPU : 4090
- Debug build
- matrixA(half) : row_major, matrixB(half) : row_major, matrixP(float) : row_major
- WMMA : 8×32×16

| GPU:4090, debug build, row_major, 8×32×16                            | sddmm_isratnisa | sddmm_zcx   |
|----------------------------------------------------------------------|-----------------|-------------|
| M : 3000, N : 7000, K : 256, nnz : 313110, sparsity : 98.51%         | 0.508448 ms     | 0.567232 ms |
| M : 2000, N : 12000, K : 256, nnz : 746000, sparsity : 96.8917%      | 1.59091 ms      | 0.577088 ms |
| M : 300000, N : 103000, K : 256, nnz : 69000000, sparsity : 99.7767% | 26.6559 ms      |             |
| M : 35000, N : 35000, K : 256, nnz : 422000, sparsity : 99.9656%     | 0.237888 ms     | 30.5323 ms  |
| M : 549000, N : 549000, K : 256, nnz : 926000, sparsity : 99.9997%   | 2.61411 ms      |             |
| M : 426000, N : 426000, K : 256, nnz : 1000000, sparsity : 99.9995%  | 2.41718 ms      |             |
| M : 37000, N : 37000, K : 256, nnz : 368000, sparsity : 99.9731%     | 0.234112 ms     | 34.361 ms   |
| M : 4000, N : 4000, K : 256, nnz : 88000, sparsity : 99.45%          | 0.172064 ms     | 0.398336 ms |
| M : 106000, N : 106000, K : 256, nnz : 3000000, sparsity : 99.9733%  | 1.97805 ms      |             |
| M : 685000, N : 685000, K : 256, nnz : 8000000, sparsity : 99.9983%  | 12.3796 ms      |             |
| M : 916000, N : 916000, K : 256, nnz : 5000000, sparsity : 99.9994%  | 9.60342 ms      |             |
| M : 326000, N : 326000, K : 256, nnz : 1000000, sparsity : 99.9991%  | 2.11952 ms      |             |
| M : 197000, N : 197000, K : 256, nnz : 2000000, sparsity : 99.9948%  | 2.10243 ms      |             |
| M : 390000, N : 390000, K : 256, nnz : 2000000, sparsity : 99.9987%  | 3.45181 ms      |             |
| M : 260000, N : 260000, K : 256, nnz : 4000000, sparsity : 99.9941%  | 4.01792 ms      |             |
| M : 241000, N : 241000, K : 256, nnz : 561000, sparsity : 99.999%    | 1.28944 ms      |             |
| M : 36000, N : 36000, K : 256, nnz : 4000000, sparsity : 99.6914%    | 1.33123 ms      | 32.917 ms   |

由于将稀疏矩阵按照0也储存的方式储存, 导致矩阵太大的情况下内存分配错误, 使得计算失败

使用 8×32×16 的维度 比 16×16×16 和 32×8×16 更慢了

---

### 在上个版本的基础上将 blockDIm 的尺寸改变成 128×4

blockDim 的尺寸改变的话时间大幅度降低.

#### 测试结果 行主序储存 16×16×16

- GPU : 4090
- Debug build
- matrixA(half) : row_major, matrixB(half) : row_major, matrixP(float) : row_major
- WMMA : 16 × 16 × 16

| GPU:4090, debug build, row_major,16×16×16                            | sddmm_isratnisa | sddmm_zcx   |
|----------------------------------------------------------------------|-----------------|-------------|
| M : 3000, N : 7000, K : 256, nnz : 313110, sparsity : 98.51%         | 0.508448 ms     | 0.280928 ms |
| M : 2000, N : 12000, K : 256, nnz : 746000, sparsity : 96.8917%      | 1.59091 ms      | 0.294144 ms |
| M : 300000, N : 103000, K : 256, nnz : 69000000, sparsity : 99.7767% | 26.6559 ms      |             |
| M : 35000, N : 35000, K : 256, nnz : 422000, sparsity : 99.9656%     | 0.237888 ms     | 16.2021 ms  |
| M : 549000, N : 549000, K : 256, nnz : 926000, sparsity : 99.9997%   | 2.61411 ms      |             |
| M : 426000, N : 426000, K : 256, nnz : 1000000, sparsity : 99.9995%  | 2.41718 ms      |             |
| M : 37000, N : 37000, K : 256, nnz : 368000, sparsity : 99.9731%     | 0.234112 ms     | 13.0718 ms  |
| M : 4000, N : 4000, K : 256, nnz : 88000, sparsity : 99.45%          | 0.172064 ms     | 0.189664 ms |
| M : 106000, N : 106000, K : 256, nnz : 3000000, sparsity : 99.9733%  | 1.97805 ms      |             |
| M : 685000, N : 685000, K : 256, nnz : 8000000, sparsity : 99.9983%  | 12.3796 ms      |             |
| M : 916000, N : 916000, K : 256, nnz : 5000000, sparsity : 99.9994%  | 9.60342 ms      |             |
| M : 326000, N : 326000, K : 256, nnz : 1000000, sparsity : 99.9991%  | 2.11952 ms      |             |
| M : 197000, N : 197000, K : 256, nnz : 2000000, sparsity : 99.9948%  | 2.10243 ms      |             |
| M : 390000, N : 390000, K : 256, nnz : 2000000, sparsity : 99.9987%  | 3.45181 ms      |             |
| M : 260000, N : 260000, K : 256, nnz : 4000000, sparsity : 99.9941%  | 4.01792 ms      |             |
| M : 241000, N : 241000, K : 256, nnz : 561000, sparsity : 99.999%    | 1.28944 ms      |             |
| M : 36000, N : 36000, K : 256, nnz : 4000000, sparsity : 99.6914%    | 1.33123 ms      | 14.1067 ms  |

由于将稀疏矩阵按照0也储存的方式储存, 导致矩阵太大的情况下内存分配错误, 使得计算失败

#### 测试结果 行主序储存 32×8×16

- GPU : 4090
- Debug build
- matrixA(half) : row_major, matrixB(half) : row_major, matrixP(float) : row_major
- WMMA : 32×8×16

| GPU:4090, debug build, row_major, 32×8×16                            | sddmm_isratnisa | sddmm_zcx   |
|----------------------------------------------------------------------|-----------------|-------------|
| M : 3000, N : 7000, K : 256, nnz : 313110, sparsity : 98.51%         | 0.508448 ms     | 0.33904 ms  |
| M : 2000, N : 12000, K : 256, nnz : 746000, sparsity : 96.8917%      | 1.59091 ms      | 0.417888 ms |
| M : 300000, N : 103000, K : 256, nnz : 69000000, sparsity : 99.7767% | 26.6559 ms      |             |
| M : 35000, N : 35000, K : 256, nnz : 422000, sparsity : 99.9656%     | 0.237888 ms     | 16.5034 ms  |
| M : 549000, N : 549000, K : 256, nnz : 926000, sparsity : 99.9997%   | 2.61411 ms      |             |
| M : 426000, N : 426000, K : 256, nnz : 1000000, sparsity : 99.9995%  | 2.41718 ms      |             |
| M : 37000, N : 37000, K : 256, nnz : 368000, sparsity : 99.9731%     | 0.234112 ms     | 18.4755 ms  |
| M : 4000, N : 4000, K : 256, nnz : 88000, sparsity : 99.45%          | 0.172064 ms     | 0.2536 ms   |
| M : 106000, N : 106000, K : 256, nnz : 3000000, sparsity : 99.9733%  | 1.97805 ms      |             |
| M : 685000, N : 685000, K : 256, nnz : 8000000, sparsity : 99.9983%  | 12.3796 ms      |             |
| M : 916000, N : 916000, K : 256, nnz : 5000000, sparsity : 99.9994%  | 9.60342 ms      |             |
| M : 326000, N : 326000, K : 256, nnz : 1000000, sparsity : 99.9991%  | 2.11952 ms      |             |
| M : 197000, N : 197000, K : 256, nnz : 2000000, sparsity : 99.9948%  | 2.10243 ms      |             |
| M : 390000, N : 390000, K : 256, nnz : 2000000, sparsity : 99.9987%  | 3.45181 ms      |             |
| M : 260000, N : 260000, K : 256, nnz : 4000000, sparsity : 99.9941%  | 4.01792 ms      |             |
| M : 241000, N : 241000, K : 256, nnz : 561000, sparsity : 99.999%    | 1.28944 ms      |             |
| M : 36000, N : 36000, K : 256, nnz : 4000000, sparsity : 99.6914%    | 1.33123 ms      | 18.8892 ms  |

由于将稀疏矩阵按照0也储存的方式储存, 导致矩阵太大的情况下内存分配错误, 使得计算失败

blockDim使用128×8的情况下, 使用 32×8×16 的维度 比 16×16×16 更慢了

#### 测试结果 行主序储存 8×32×16

- GPU : 4090
- Debug build
- matrixA(half) : row_major, matrixB(half) : row_major, matrixP(float) : row_major
- WMMA : 8×32×16

| GPU:4090, debug build, row_major, 8×32×16                            | sddmm_isratnisa | sddmm_zcx   |
|----------------------------------------------------------------------|-----------------|-------------|
| M : 3000, N : 7000, K : 256, nnz : 313110, sparsity : 98.51%         | 0.508448 ms     | 0.311552 ms |
| M : 2000, N : 12000, K : 256, nnz : 746000, sparsity : 96.8917%      | 1.59091 ms      | 0.326208 ms |
| M : 300000, N : 103000, K : 256, nnz : 69000000, sparsity : 99.7767% | 26.6559 ms      |             |
| M : 35000, N : 35000, K : 256, nnz : 422000, sparsity : 99.9656%     | 0.237888 ms     | 20.6243 ms  |
| M : 549000, N : 549000, K : 256, nnz : 926000, sparsity : 99.9997%   | 2.61411 ms      |             |
| M : 426000, N : 426000, K : 256, nnz : 1000000, sparsity : 99.9995%  | 2.41718 ms      |             |
| M : 37000, N : 37000, K : 256, nnz : 368000, sparsity : 99.9731%     | 0.234112 ms     | 16.8907 ms  |
| M : 4000, N : 4000, K : 256, nnz : 88000, sparsity : 99.45%          | 0.172064 ms     | 0.214592 ms |
| M : 106000, N : 106000, K : 256, nnz : 3000000, sparsity : 99.9733%  | 1.97805 ms      |             |
| M : 685000, N : 685000, K : 256, nnz : 8000000, sparsity : 99.9983%  | 12.3796 ms      |             |
| M : 916000, N : 916000, K : 256, nnz : 5000000, sparsity : 99.9994%  | 9.60342 ms      |             |
| M : 326000, N : 326000, K : 256, nnz : 1000000, sparsity : 99.9991%  | 2.11952 ms      |             |
| M : 197000, N : 197000, K : 256, nnz : 2000000, sparsity : 99.9948%  | 2.10243 ms      |             |
| M : 390000, N : 390000, K : 256, nnz : 2000000, sparsity : 99.9987%  | 3.45181 ms      |             |
| M : 260000, N : 260000, K : 256, nnz : 4000000, sparsity : 99.9941%  | 4.01792 ms      |             |
| M : 241000, N : 241000, K : 256, nnz : 561000, sparsity : 99.999%    | 1.28944 ms      |             |
| M : 36000, N : 36000, K : 256, nnz : 4000000, sparsity : 99.6914%    | 1.33123 ms      | 16.0298 ms  |

由于将稀疏矩阵按照0也储存的方式储存, 导致矩阵太大的情况下内存分配错误, 使得计算失败

blockDim使用128×8的情况下, 使用 8×32×16 的维度有的变快有的变慢

---

### TensorCore 测试 warp 中数据储存格式

实际测试出的 warp 中每一个线程所储存的数据代表的行列:

#### M = 16, N = 16, K = 16

##### Matrix A (16×16) (FP16):

|    | 0   | 1   | 2   | 3   | 4   | 5   | 6   | 7   | 8   | 9   | 10  | 11  | 12  | 13  | 14  | 15  |
|----|-----|-----|-----|-----|-----|-----|-----|-----|-----|-----|-----|-----|-----|-----|-----|-----|
| 0  | 0   | 1   | 2   | 3   | 4   | 5   | 6   | 7   | 8   | 9   | 10  | 11  | 12  | 13  | 14  | 15  |
| 1  | 16  | 17  | 18  | 19  | 20  | 21  | 22  | 23  | 24  | 25  | 26  | 27  | 28  | 29  | 30  | 31  |
| 2  | 32  | 33  | 34  | 35  | 36  | 37  | 38  | 39  | 40  | 41  | 42  | 43  | 44  | 45  | 46  | 47  |
| 3  | 48  | 49  | 50  | 51  | 52  | 53  | 54  | 55  | 56  | 57  | 58  | 59  | 60  | 61  | 62  | 63  |
| 4  | 64  | 65  | 66  | 67  | 68  | 69  | 70  | 71  | 72  | 73  | 74  | 75  | 76  | 77  | 78  | 79  |
| 5  | 80  | 81  | 82  | 83  | 84  | 85  | 86  | 87  | 88  | 89  | 90  | 91  | 92  | 93  | 94  | 95  |
| 6  | 96  | 97  | 98  | 99  | 100 | 101 | 102 | 103 | 104 | 105 | 106 | 107 | 108 | 109 | 110 | 111 |
| 7  | 112 | 113 | 114 | 115 | 116 | 117 | 118 | 119 | 120 | 121 | 122 | 123 | 124 | 125 | 126 | 127 |
| 8  | 128 | 129 | 130 | 131 | 132 | 133 | 134 | 135 | 136 | 137 | 138 | 139 | 140 | 141 | 142 | 143 |
| 9  | 144 | 145 | 146 | 147 | 148 | 149 | 150 | 151 | 152 | 153 | 154 | 155 | 156 | 157 | 158 | 159 |
| 10 | 160 | 161 | 162 | 163 | 164 | 165 | 166 | 167 | 168 | 169 | 170 | 171 | 172 | 173 | 174 | 175 |
| 11 | 176 | 177 | 178 | 179 | 180 | 181 | 182 | 183 | 184 | 185 | 186 | 187 | 188 | 189 | 190 | 191 |
| 12 | 192 | 193 | 194 | 195 | 196 | 197 | 198 | 199 | 200 | 201 | 202 | 203 | 204 | 205 | 206 | 207 |
| 13 | 208 | 209 | 210 | 211 | 212 | 213 | 214 | 215 | 216 | 217 | 218 | 219 | 220 | 221 | 222 | 223 |
| 14 | 224 | 225 | 226 | 227 | 228 | 229 | 230 | 231 | 232 | 233 | 234 | 235 | 236 | 237 | 238 | 239 |
| 15 | 240 | 241 | 242 | 243 | 244 | 245 | 246 | 247 | 248 | 249 | 250 | 251 | 252 | 253 | 254 | 255 |

##### Matrix B (16×16) (FP16):

|    | 0   | 1   | 2   | 3   | 4   | 5   | 6   | 7   | 8   | 9   | 10  | 11  | 12  | 13  | 14  | 15  |
|----|-----|-----|-----|-----|-----|-----|-----|-----|-----|-----|-----|-----|-----|-----|-----|-----|
| 0  | 0   | 1   | 2   | 3   | 4   | 5   | 6   | 7   | 8   | 9   | 10  | 11  | 12  | 13  | 14  | 15  |
| 1  | 16  | 17  | 18  | 19  | 20  | 21  | 22  | 23  | 24  | 25  | 26  | 27  | 28  | 29  | 30  | 31  |
| 2  | 32  | 33  | 34  | 35  | 36  | 37  | 38  | 39  | 40  | 41  | 42  | 43  | 44  | 45  | 46  | 47  |
| 3  | 48  | 49  | 50  | 51  | 52  | 53  | 54  | 55  | 56  | 57  | 58  | 59  | 60  | 61  | 62  | 63  |
| 4  | 64  | 65  | 66  | 67  | 68  | 69  | 70  | 71  | 72  | 73  | 74  | 75  | 76  | 77  | 78  | 79  |
| 5  | 80  | 81  | 82  | 83  | 84  | 85  | 86  | 87  | 88  | 89  | 90  | 91  | 92  | 93  | 94  | 95  |
| 6  | 96  | 97  | 98  | 99  | 100 | 101 | 102 | 103 | 104 | 105 | 106 | 107 | 108 | 109 | 110 | 111 |
| 7  | 112 | 113 | 114 | 115 | 116 | 117 | 118 | 119 | 120 | 121 | 122 | 123 | 124 | 125 | 126 | 127 |
| 8  | 128 | 129 | 130 | 131 | 132 | 133 | 134 | 135 | 136 | 137 | 138 | 139 | 140 | 141 | 142 | 143 |
| 9  | 144 | 145 | 146 | 147 | 148 | 149 | 150 | 151 | 152 | 153 | 154 | 155 | 156 | 157 | 158 | 159 |
| 10 | 160 | 161 | 162 | 163 | 164 | 165 | 166 | 167 | 168 | 169 | 170 | 171 | 172 | 173 | 174 | 175 |
| 11 | 176 | 177 | 178 | 179 | 180 | 181 | 182 | 183 | 184 | 185 | 186 | 187 | 188 | 189 | 190 | 191 |
| 12 | 192 | 193 | 194 | 195 | 196 | 197 | 198 | 199 | 200 | 201 | 202 | 203 | 204 | 205 | 206 | 207 |
| 13 | 208 | 209 | 210 | 211 | 212 | 213 | 214 | 215 | 216 | 217 | 218 | 219 | 220 | 221 | 222 | 223 |
| 14 | 224 | 225 | 226 | 227 | 228 | 229 | 230 | 231 | 232 | 233 | 234 | 235 | 236 | 237 | 238 | 239 |
| 15 | 240 | 241 | 242 | 243 | 244 | 245 | 246 | 247 | 248 | 249 | 250 | 251 | 252 | 253 | 254 | 255 |

##### Matrix C (16×16) (FP32):

|    | 0      | 1      | 2      | 3      | 4      | 5      | 6      | 7      | 8      | 9      | 10     | 11     | 12     | 13     | 14     | 15     |
|----|--------|--------|--------|--------|--------|--------|--------|--------|--------|--------|--------|--------|--------|--------|--------|--------|
| 0  | 19840  | 19960  | 20080  | 20200  | 20320  | 20440  | 20560  | 20680  | 20800  | 20920  | 21040  | 21160  | 21280  | 21400  | 21520  | 21640  |
| 1  | 50560  | 50936  | 51312  | 51688  | 52064  | 52440  | 52816  | 53192  | 53568  | 53944  | 54320  | 54696  | 55072  | 55448  | 55824  | 56200  |
| 2  | 81280  | 81912  | 82544  | 83176  | 83808  | 84440  | 85072  | 85704  | 86336  | 86968  | 87600  | 88232  | 88864  | 89496  | 90128  | 90760  |
| 3  | 112000 | 112888 | 113776 | 114664 | 115552 | 116440 | 117328 | 118216 | 119104 | 119992 | 120880 | 121768 | 122656 | 123544 | 124432 | 125320 |
| 4  | 142720 | 143864 | 145008 | 146152 | 147296 | 148440 | 149584 | 150728 | 151872 | 153016 | 154160 | 155304 | 156448 | 157592 | 158736 | 159880 |
| 5  | 173440 | 174840 | 176240 | 177640 | 179040 | 180440 | 181840 | 183240 | 184640 | 186040 | 187440 | 188840 | 190240 | 191640 | 193040 | 194440 |
| 6  | 204160 | 205816 | 207472 | 209128 | 210784 | 212440 | 214096 | 215752 | 217408 | 219064 | 220720 | 222376 | 224032 | 225688 | 227344 | 229000 |
| 7  | 234880 | 236792 | 238704 | 240616 | 242528 | 244440 | 246352 | 248264 | 250176 | 252088 | 254000 | 255912 | 257824 | 259736 | 261648 | 263560 |
| 8  | 265600 | 267768 | 269936 | 272104 | 274272 | 276440 | 278608 | 280776 | 282944 | 285112 | 287280 | 289448 | 291616 | 293784 | 295952 | 298120 |
| 9  | 296320 | 298744 | 301168 | 303592 | 306016 | 308440 | 310864 | 313288 | 315712 | 318136 | 320560 | 322984 | 325408 | 327832 | 330256 | 332680 |
| 10 | 327040 | 329720 | 332400 | 335080 | 337760 | 340440 | 343120 | 345800 | 348480 | 351160 | 353840 | 356520 | 359200 | 361880 | 364560 | 367240 |
| 11 | 357760 | 360696 | 363632 | 366568 | 369504 | 372440 | 375376 | 378312 | 381248 | 384184 | 387120 | 390056 | 392992 | 395928 | 398864 | 401800 |
| 12 | 388480 | 391672 | 394864 | 398056 | 401248 | 404440 | 407632 | 410824 | 414016 | 417208 | 420400 | 423592 | 426784 | 429976 | 433168 | 436360 |
| 13 | 419200 | 422648 | 426096 | 429544 | 432992 | 436440 | 439888 | 443336 | 446784 | 450232 | 453680 | 457128 | 460576 | 464024 | 467472 | 470920 |
| 14 | 449920 | 453624 | 457328 | 461032 | 464736 | 468440 | 472144 | 475848 | 479552 | 483256 | 486960 | 490664 | 494368 | 498072 | 501776 | 505480 |
| 15 | 480640 | 484600 | 488560 | 492520 | 496480 | 500440 | 504400 | 508360 | 512320 | 516280 | 520240 | 524200 | 528160 | 532120 | 536080 | 540040 |

##### warp 中每个线程实际储存的数据

| landId\idx |   0    |   1    |   2    |   3    |   4    |   5    |   6    |   7    |
|:----------:|:------:|:------:|:------:|:------:|:------:|:------:|:------:|:------:|
|     T0     | 19840  | 19960  | 265600 | 267768 | 20800  | 20920  | 282944 | 285112 |
|     T1     | 20080  | 20200  | 269936 | 272104 | 21040  | 21160  | 287280 | 289448 |
|     T2     | 20320  | 20440  | 274272 | 276440 | 21280  | 21400  | 291616 | 293784 |
|     T3     | 20560  | 20680  | 278608 | 280776 | 21520  | 21640  | 295952 | 298120 |
|     T4     | 50560  | 50936  | 296320 | 298744 | 53568  | 53944  | 315712 | 318136 |
|     T5     | 51312  | 51688  | 301168 | 303592 | 54320  | 54696  | 320560 | 322984 |
|     T6     | 52064  | 52440  | 306016 | 308440 | 55072  | 55448  | 325408 | 327832 |
|     T7     | 52816  | 53192  | 310864 | 313288 | 55824  | 56200  | 330256 | 332680 |
|     T8     | 81280  | 81912  | 327040 | 329720 | 86336  | 86968  | 348480 | 351160 |
|     T9     | 82544  | 83176  | 332400 | 335080 | 87600  | 88232  | 353840 | 356520 |
|    T10     | 83808  | 84440  | 337760 | 340440 | 88864  | 89496  | 359200 | 361880 |
|    T11     | 85072  | 85704  | 343120 | 345800 | 90128  | 90760  | 364560 | 367240 |
|    T12     | 112000 | 112888 | 357760 | 360696 | 119104 | 119992 | 381248 | 384184 |
|    T13     | 113776 | 114664 | 363632 | 366568 | 120880 | 121768 | 387120 | 390056 |
|    T14     | 115552 | 116440 | 369504 | 372440 | 122656 | 123544 | 392992 | 395928 |
|    T15     | 117328 | 118216 | 375376 | 378312 | 124432 | 125320 | 398864 | 401800 |
|    T16     | 142720 | 143864 | 388480 | 391672 | 151872 | 153016 | 414016 | 417208 |
|    T17     | 145008 | 146152 | 394864 | 398056 | 154160 | 155304 | 420400 | 423592 |
|    T18     | 147296 | 148440 | 401248 | 404440 | 156448 | 157592 | 426784 | 429976 |
|    T19     | 149584 | 150728 | 407632 | 410824 | 158736 | 159880 | 433168 | 436360 |
|    T20     | 173440 | 174840 | 419200 | 422648 | 184640 | 186040 | 446784 | 450232 |
|    T21     | 176240 | 177640 | 426096 | 429544 | 187440 | 188840 | 453680 | 457128 |
|    T22     | 179040 | 180440 | 432992 | 436440 | 190240 | 191640 | 460576 | 464024 |
|    T23     | 181840 | 183240 | 439888 | 443336 | 193040 | 194440 | 467472 | 470920 |
|    T24     | 204160 | 205816 | 449920 | 453624 | 217408 | 219064 | 479552 | 483256 |
|    T25     | 207472 | 209128 | 457328 | 461032 | 220720 | 222376 | 486960 | 490664 |
|    T26     | 210784 | 212440 | 464736 | 468440 | 224032 | 225688 | 494368 | 498072 |
|    T27     | 214096 | 215752 | 472144 | 475848 | 227344 | 229000 | 501776 | 505480 |
|    T28     | 234880 | 236792 | 480640 | 484600 | 250176 | 252088 | 512320 | 516280 |
|    T29     | 238704 | 240616 | 488560 | 492520 | 254000 | 255912 | 520240 | 524200 |
|    T30     | 242528 | 244440 | 496480 | 500440 | 257824 | 259736 | 528160 | 532120 |
|    T31     | 246352 | 248264 | 504400 | 508360 | 261648 | 263560 | 536080 | 540040 |

##### 整理后对应的列表:

| landId\idx |   0   |   1   |   2    |   3    |   4    |   5    |    6    |    7    |
|:----------:|:-----:|:-----:|:------:|:------:|:------:|:------:|:-------:|:-------:|
|     T0     | [0,0] | [0,1] | [8,0]  | [8,1]  | [0,8]  | [0,9]  |  [8,8]  |  [8,9]  |
|     T1     | [0,2] | [0,3] | [8,2]  | [8,3]  | [0,10] | [0,11] | [8,10]  | [8,11]  |
|     T2     | [0,4] | [0,5] | [8,4]  | [8,5]  | [0,12] | [0,13] | [8,12]  | [8,13]  |
|     T3     | [0,6] | [0,7] | [8,6]  | [8,7]  | [0,14] | [0,15] | [8,14]  | [8,15]  |
|     T4     | [1,0] | [1,1] | [9,0]  | [9,1]  | [1,8]  | [1,9]  |  [9,8]  |  [9,9]  |
|     T5     | [1,2] | [1,3] | [9,2]  | [9,3]  | [1,10] | [1,11] | [9,10]  | [9,11]  |
|     T6     | [1,4] | [1,5] | [9,4]  | [9,5]  | [1,12] | [1,13] | [9,12]  | [9,13]  | 
|     T7     | [1,6] | [1,7] | [9,6]  | [9,7]  | [1,14] | [1,15] | [9,14]  | [9,15]  |
|     T8     | [2,0] | [2,1] | [10,0] | [10,1] | [2,8]  | [2,9]  | [10,8]  | [10,9]  |
|     T9     | [2,2] | [2,3] | [10,2] | [10,3] | [2,10] | [2,11] | [10,10] | [10,11] |
|    T10     | [2,4] | [2,5] | [10,4] | [10,5] | [2,14] | [2,15] | [10,12] | [10,13] |    
|    T11     | [2,6] | [2,7] | [10,6] | [10,7] | [2,16] | [2,17] | [10,14] | [10,15] |
|    T12     | [3,0] | [3,1] | [11,0] | [11,1] | [3,8]  | [3,9]  | [11,8]  | [11,9]  |
|    T13     | [3,2] | [3,3] | [11,2] | [11,3] | [3,10] | [3,11] | [11,10] | [11,11] |
|    T14     | [3,4] | [3,5] | [11,4] | [11,5] | [3,12] | [3,13] | [11,12] | [11,13] |
|    T15     | [3,6] | [3,7] | [11,6] | [11,7] | [3,14] | [3,15] | [11,14] | [11,15] |
|    T16     | [4,0] | [4,1] | [12,0] | [12,1] | [4,8]  | [4,9]  | [12,8]  | [12,9]  |
|    T17     | [4,2] | [4,3] | [12,2] | [12,3] | [4,10] | [4,11] | [12,10] | [12,11] |
|    T18     | [4,4] | [4,5] | [12,4] | [12,5] | [4,12] | [4,13] | [12,12] | [12,13] |
|    T19     | [4,6] | [4,7] | [12,6] | [12,7] | [4,14] | [4,15] | [12,14] | [12,15] |
|    T20     | [5,0] | [5,1] | [13,0] | [13,1] | [5,8]  | [5,9]  | [13,8]  | [13,9]  |
|    T21     | [5,2] | [5,3] | [13,2] | [13,3] | [5,10] | [5,11] | [13,10] | [13,11] |
|    T22     | [5,4] | [5,5] | [13,4] | [13,5] | [5,12] | [5,13] | [13,12] | [13,13] |
|    T23     | [5,6] | [5,7] | [13,6] | [13,7] | [5,14] | [5,15] | [13,14] | [13,15] |
|    T24     | [6,0] | [6,1] | [14,0] | [14,1] | [6,8]  | [6,9]  | [14,8]  | [14,9]  |
|    T25     | [6,2] | [6,3] | [14,2] | [14,3] | [6,10] | [6,11] | [14,10] | [14,11] |
|    T26     | [6,4] | [6,5] | [14,4] | [14,5] | [6,12] | [6,13] | [14,12] | [14,13] |
|    T27     | [6,6] | [6,7] | [14,6] | [14,7] | [6,14] | [6,15] | [14,14] | [14,15] |
|    T28     | [7,0] | [7,1] | [15,0] | [15,1] | [7,8]  | [7,9]  | [15,8]  | [15,9]  |
|    T29     | [7,2] | [7,3] | [15,2] | [15,3] | [7,10] | [7,11] | [15,10] | [15,11] |
|    T30     | [7,4] | [7,5] | [15,4] | [15,5] | [7,12] | [7,13] | [15,12] | [15,13] |
|    T31     | [7,6] | [7,7] | [15,6] | [15,7] | [7,14] | [7,15] | [15,14] | [15,15] |

#### M = 32, N = 8, K = 16

##### Matrix A (32×16) (FP16):

|    | 0   | 1   | 2   | 3   | 4   | 5   | 6   | 7   | 8   | 9   | 10  | 11  | 12  | 13  | 14  | 15  |
|----|-----|-----|-----|-----|-----|-----|-----|-----|-----|-----|-----|-----|-----|-----|-----|-----|
| 0  | 0   | 1   | 2   | 3   | 4   | 5   | 6   | 7   | 8   | 9   | 10  | 11  | 12  | 13  | 14  | 15  |
| 1  | 16  | 17  | 18  | 19  | 20  | 21  | 22  | 23  | 24  | 25  | 26  | 27  | 28  | 29  | 30  | 31  |
| 2  | 32  | 33  | 34  | 35  | 36  | 37  | 38  | 39  | 40  | 41  | 42  | 43  | 44  | 45  | 46  | 47  |
| 3  | 48  | 49  | 50  | 51  | 52  | 53  | 54  | 55  | 56  | 57  | 58  | 59  | 60  | 61  | 62  | 63  |
| 4  | 64  | 65  | 66  | 67  | 68  | 69  | 70  | 71  | 72  | 73  | 74  | 75  | 76  | 77  | 78  | 79  |
| 5  | 80  | 81  | 82  | 83  | 84  | 85  | 86  | 87  | 88  | 89  | 90  | 91  | 92  | 93  | 94  | 95  |
| 6  | 96  | 97  | 98  | 99  | 100 | 101 | 102 | 103 | 104 | 105 | 106 | 107 | 108 | 109 | 110 | 111 |
| 7  | 112 | 113 | 114 | 115 | 116 | 117 | 118 | 119 | 120 | 121 | 122 | 123 | 124 | 125 | 126 | 127 |
| 8  | 128 | 129 | 130 | 131 | 132 | 133 | 134 | 135 | 136 | 137 | 138 | 139 | 140 | 141 | 142 | 143 |
| 9  | 144 | 145 | 146 | 147 | 148 | 149 | 150 | 151 | 152 | 153 | 154 | 155 | 156 | 157 | 158 | 159 |
| 10 | 160 | 161 | 162 | 163 | 164 | 165 | 166 | 167 | 168 | 169 | 170 | 171 | 172 | 173 | 174 | 175 |
| 11 | 176 | 177 | 178 | 179 | 180 | 181 | 182 | 183 | 184 | 185 | 186 | 187 | 188 | 189 | 190 | 191 |
| 12 | 192 | 193 | 194 | 195 | 196 | 197 | 198 | 199 | 200 | 201 | 202 | 203 | 204 | 205 | 206 | 207 |
| 13 | 208 | 209 | 210 | 211 | 212 | 213 | 214 | 215 | 216 | 217 | 218 | 219 | 220 | 221 | 222 | 223 |
| 14 | 224 | 225 | 226 | 227 | 228 | 229 | 230 | 231 | 232 | 233 | 234 | 235 | 236 | 237 | 238 | 239 |
| 15 | 240 | 241 | 242 | 243 | 244 | 245 | 246 | 247 | 248 | 249 | 250 | 251 | 252 | 253 | 254 | 255 |
| 16 | 256 | 257 | 258 | 259 | 260 | 261 | 262 | 263 | 264 | 265 | 266 | 267 | 268 | 269 | 270 | 271 |
| 17 | 272 | 273 | 274 | 275 | 276 | 277 | 278 | 279 | 280 | 281 | 282 | 283 | 284 | 285 | 286 | 287 |
| 18 | 288 | 289 | 290 | 291 | 292 | 293 | 294 | 295 | 296 | 297 | 298 | 299 | 300 | 301 | 302 | 303 |
| 19 | 304 | 305 | 306 | 307 | 308 | 309 | 310 | 311 | 312 | 313 | 314 | 315 | 316 | 317 | 318 | 319 |
| 20 | 320 | 321 | 322 | 323 | 324 | 325 | 326 | 327 | 328 | 329 | 330 | 331 | 332 | 333 | 334 | 335 |
| 21 | 336 | 337 | 338 | 339 | 340 | 341 | 342 | 343 | 344 | 345 | 346 | 347 | 348 | 349 | 350 | 351 |
| 22 | 352 | 353 | 354 | 355 | 356 | 357 | 358 | 359 | 360 | 361 | 362 | 363 | 364 | 365 | 366 | 367 |
| 23 | 368 | 369 | 370 | 371 | 372 | 373 | 374 | 375 | 376 | 377 | 378 | 379 | 380 | 381 | 382 | 383 |
| 24 | 384 | 385 | 386 | 387 | 388 | 389 | 390 | 391 | 392 | 393 | 394 | 395 | 396 | 397 | 398 | 399 |
| 25 | 400 | 401 | 402 | 403 | 404 | 405 | 406 | 407 | 408 | 409 | 410 | 411 | 412 | 413 | 414 | 415 |
| 26 | 416 | 417 | 418 | 419 | 420 | 421 | 422 | 423 | 424 | 425 | 426 | 427 | 428 | 429 | 430 | 431 |
| 27 | 432 | 433 | 434 | 435 | 436 | 437 | 438 | 439 | 440 | 441 | 442 | 443 | 444 | 445 | 446 | 447 |
| 28 | 448 | 449 | 450 | 451 | 452 | 453 | 454 | 455 | 456 | 457 | 458 | 459 | 460 | 461 | 462 | 463 |
| 29 | 464 | 465 | 466 | 467 | 468 | 469 | 470 | 471 | 472 | 473 | 474 | 475 | 476 | 477 | 478 | 479 |
| 30 | 480 | 481 | 482 | 483 | 484 | 485 | 486 | 487 | 488 | 489 | 490 | 491 | 492 | 493 | 494 | 495 |
| 31 | 496 | 497 | 498 | 499 | 500 | 501 | 502 | 503 | 504 | 505 | 506 | 507 | 508 | 509 | 510 | 511 |

##### Matrix B (16×8) (FP16):

|    | 0   | 1   | 2   | 3   | 4   | 5   | 6   | 7   |
|----|-----|-----|-----|-----|-----|-----|-----|-----|
| 0  | 0   | 1   | 2   | 3   | 4   | 5   | 6   | 7   |
| 1  | 8   | 9   | 10  | 11  | 12  | 13  | 14  | 15  |
| 2  | 16  | 17  | 18  | 19  | 20  | 21  | 22  | 23  |
| 3  | 24  | 25  | 26  | 27  | 28  | 29  | 30  | 31  |
| 4  | 32  | 33  | 34  | 35  | 36  | 37  | 38  | 39  |
| 5  | 40  | 41  | 42  | 43  | 44  | 45  | 46  | 47  |
| 6  | 48  | 49  | 50  | 51  | 52  | 53  | 54  | 55  |
| 7  | 56  | 57  | 58  | 59  | 60  | 61  | 62  | 63  |
| 8  | 64  | 65  | 66  | 67  | 68  | 69  | 70  | 71  |
| 9  | 72  | 73  | 74  | 75  | 76  | 77  | 78  | 79  |
| 10 | 80  | 81  | 82  | 83  | 84  | 85  | 86  | 87  |
| 11 | 88  | 89  | 90  | 91  | 92  | 93  | 94  | 95  |
| 12 | 96  | 97  | 98  | 99  | 100 | 101 | 102 | 103 |
| 13 | 104 | 105 | 106 | 107 | 108 | 109 | 110 | 111 |
| 14 | 112 | 113 | 114 | 115 | 116 | 117 | 118 | 119 |
| 15 | 120 | 121 | 122 | 123 | 124 | 125 | 126 | 127 |

##### Matrix C (32×8) (FP32):

|    | 0      | 1      | 2      | 3      | 4      | 5      | 6      | 7      |
|----|--------|--------|--------|--------|--------|--------|--------|--------|
| 0  | 9920   | 10040  | 10160  | 10280  | 10400  | 10520  | 10640  | 10760  |
| 1  | 25280  | 25656  | 26032  | 26408  | 26784  | 27160  | 27536  | 27912  |
| 2  | 40640  | 41272  | 41904  | 42536  | 43168  | 43800  | 44432  | 45064  |
| 3  | 56000  | 56888  | 57776  | 58664  | 59552  | 60440  | 61328  | 62216  |
| 4  | 71360  | 72504  | 73648  | 74792  | 75936  | 77080  | 78224  | 79368  |
| 5  | 86720  | 88120  | 89520  | 90920  | 92320  | 93720  | 95120  | 96520  |
| 6  | 102080 | 103736 | 105392 | 107048 | 108704 | 110360 | 112016 | 113672 |
| 7  | 117440 | 119352 | 121264 | 123176 | 125088 | 127000 | 128912 | 130824 |
| 8  | 132800 | 134968 | 137136 | 139304 | 141472 | 143640 | 145808 | 147976 |
| 9  | 148160 | 150584 | 153008 | 155432 | 157856 | 160280 | 162704 | 165128 |
| 10 | 163520 | 166200 | 168880 | 171560 | 174240 | 176920 | 179600 | 182280 |
| 11 | 178880 | 181816 | 184752 | 187688 | 190624 | 193560 | 196496 | 199432 |
| 12 | 194240 | 197432 | 200624 | 203816 | 207008 | 210200 | 213392 | 216584 |
| 13 | 209600 | 213048 | 216496 | 219944 | 223392 | 226840 | 230288 | 233736 |
| 14 | 224960 | 228664 | 232368 | 236072 | 239776 | 243480 | 247184 | 250888 |
| 15 | 240320 | 244280 | 248240 | 252200 | 256160 | 260120 | 264080 | 268040 |
| 16 | 255680 | 259896 | 264112 | 268328 | 272544 | 276760 | 280976 | 285192 |
| 17 | 271040 | 275512 | 279984 | 284456 | 288928 | 293400 | 297872 | 302344 |
| 18 | 286400 | 291128 | 295856 | 300584 | 305312 | 310040 | 314768 | 319496 |
| 19 | 301760 | 306744 | 311728 | 316712 | 321696 | 326680 | 331664 | 336648 |
| 20 | 317120 | 322360 | 327600 | 332840 | 338080 | 343320 | 348560 | 353800 |
| 21 | 332480 | 337976 | 343472 | 348968 | 354464 | 359960 | 365456 | 370952 |
| 22 | 347840 | 353592 | 359344 | 365096 | 370848 | 376600 | 382352 | 388104 |
| 23 | 363200 | 369208 | 375216 | 381224 | 387232 | 393240 | 399248 | 405256 |
| 24 | 378560 | 384824 | 391088 | 397352 | 403616 | 409880 | 416144 | 422408 |
| 25 | 393920 | 400440 | 406960 | 413480 | 420000 | 426520 | 433040 | 439560 |
| 26 | 409280 | 416056 | 422832 | 429608 | 436384 | 443160 | 449936 | 456712 |
| 27 | 424640 | 431672 | 438704 | 445736 | 452768 | 459800 | 466832 | 473864 |
| 28 | 440000 | 447288 | 454576 | 461864 | 469152 | 476440 | 483728 | 491016 |
| 29 | 455360 | 462904 | 470448 | 477992 | 485536 | 493080 | 500624 | 508168 |
| 30 | 470720 | 478520 | 486320 | 494120 | 501920 | 509720 | 517520 | 525320 |
| 31 | 486080 | 494136 | 502192 | 510248 | 518304 | 526360 | 534416 | 542472 |

##### warp 中每个线程实际储存的数据

| landId\idx |   0    |   1    |   2    |   3    |   4    |   5    |   6    |   7    |
|:----------:|:------:|:------:|:------:|:------:|:------:|:------:|:------:|:------:|
|     T0     |  9920  | 10040  | 132800 | 134968 | 255680 | 259896 | 378560 | 384824 |
|     T1     | 10160  | 10280  | 137136 | 139304 | 264112 | 268328 | 391088 | 397352 |
|     T2     | 10400  | 10520  | 141472 | 143640 | 272544 | 276760 | 403616 | 409880 |
|     T3     | 10640  | 10760  | 145808 | 147976 | 280976 | 285192 | 416144 | 422408 |
|     T4     | 25280  | 25656  | 148160 | 150584 | 271040 | 275512 | 393920 | 400440 |
|     T5     | 26032  | 26408  | 153008 | 155432 | 279984 | 284456 | 406960 | 413480 |
|     T6     | 26784  | 27160  | 157856 | 160280 | 288928 | 293400 | 420000 | 426520 |
|     T7     | 27536  | 27912  | 162704 | 165128 | 297872 | 302344 | 433040 | 439560 |
|     T8     | 40640  | 41272  | 163520 | 166200 | 286400 | 291128 | 409280 | 416056 |
|     T9     | 41904  | 42536  | 168880 | 171560 | 295856 | 300584 | 422832 | 429608 |
|    T10     | 43168  | 43800  | 174240 | 176920 | 305312 | 310040 | 436384 | 443160 |
|    T11     | 44432  | 45064  | 179600 | 182280 | 314768 | 319496 | 449936 | 456712 |
|    T12     | 56000  | 56888  | 178880 | 181816 | 301760 | 306744 | 424640 | 431672 |
|    T13     | 57776  | 58664  | 184752 | 187688 | 311728 | 316712 | 438704 | 445736 |
|    T14     | 59552  | 60440  | 190624 | 193560 | 321696 | 326680 | 452768 | 459800 |
|    T15     | 61328  | 62216  | 196496 | 199432 | 331664 | 336648 | 466832 | 473864 |
|    T16     | 71360  | 72504  | 194240 | 197432 | 317120 | 322360 | 440000 | 447288 |
|    T17     | 73648  | 74792  | 200624 | 203816 | 327600 | 332840 | 454576 | 461864 |
|    T18     | 75936  | 77080  | 207008 | 210200 | 338080 | 343320 | 469152 | 476440 |
|    T19     | 78224  | 79368  | 213392 | 216584 | 348560 | 353800 | 483728 | 491016 |
|    T20     | 86720  | 88120  | 209600 | 213048 | 332480 | 337976 | 455360 | 462904 |
|    T21     | 89520  | 90920  | 216496 | 219944 | 343472 | 348968 | 470448 | 477992 |
|    T22     | 92320  | 93720  | 223392 | 226840 | 354464 | 359960 | 485536 | 493080 |
|    T23     | 95120  | 96520  | 230288 | 233736 | 365456 | 370952 | 500624 | 508168 |
|    T24     | 102080 | 103736 | 224960 | 228664 | 347840 | 353592 | 470720 | 478520 |
|    T25     | 105392 | 107048 | 232368 | 236072 | 359344 | 365096 | 486320 | 494120 |
|    T26     | 108704 | 110360 | 239776 | 243480 | 370848 | 376600 | 501920 | 509720 |
|    T27     | 112016 | 113672 | 247184 | 250888 | 382352 | 388104 | 517520 | 525320 |
|    T28     | 117440 | 119352 | 240320 | 244280 | 363200 | 369208 | 486080 | 494136 |
|    T29     | 121264 | 123176 | 248240 | 252200 | 375216 | 381224 | 502192 | 510248 |
|    T30     | 125088 | 127000 | 256160 | 260120 | 387232 | 393240 | 518304 | 526360 |
|    T31     | 128912 | 130824 | 264080 | 268040 | 399248 | 405256 | 534416 | 542472 |

##### 整理后对应的列表:

| landId\idx |   0   |   1   |   2    |   3    |   4    |   5    |   6    |   7    |
|:----------:|:-----:|:-----:|:------:|:------:|:------:|:------:|:------:|:------:|
|     T0     | [0,0] | [0,1] | [8,0]  | [8,1]  | [16,0] | [16,1] | [24,0] | [24,1] |
|     T1     | [0,2] | [0,3] | [8,2]  | [8,3]  | [16,2] | [16,3] | [24,2] | [24,3] |
|     T2     | [0,4] | [0,5] | [8,4]  | [8,5]  | [16,4] | [16,5] | [24,4] | [24,5] |
|     T3     | [0,6] | [0,7] | [8,6]  | [8,7]  | [16,6] | [16,7] | [24,6] | [24,7] |
|     T4     | [1,0] | [1,1] | [9,0]  | [9,1]  | [17,0] | [17,1] | [25,0] | [25,1] |
|     T5     | [1,2] | [1,3] | [9,2]  | [9,3]  | [17,2] | [17,3] | [25,2] | [25,3] |
|     T6     | [1,4] | [1,5] | [9,4]  | [9,5]  | [17,4] | [17,5] | [25,4] | [25,5] |
|     T7     | [1,6] | [1,7] | [9,6]  | [9,7]  | [17,6] | [17,7] | [25,6] | [25,7] |
|     T8     | [2,0] | [2,1] | [10,0] | [10,1] | [18,0] | [18,1] | [26,0] | [26,1] |
|     T9     | [2,2] | [2,3] | [10,2] | [10,3] | [18,2] | [18,3] | [26,2] | [26,3] |
|    T10     | [2,4] | [2,5] | [10,4] | [10,5] | [18,4] | [18,5] | [26,4] | [26,5] |
|    T11     | [2,6] | [2,7] | [10,6] | [10,7] | [18,6] | [18,7] | [26,6] | [26,7] |
|    T12     | [3,0] | [3,1] | [11,0] | [11,1] | [19,0] | [19,1] | [27,0] | [27,1] |
|    T13     | [3,2] | [3,3] | [11,2] | [11,3] | [19,2] | [19,3] | [27,2] | [27,3] |
|    T14     | [3,4] | [3,5] | [11,4] | [11,5] | [19,4] | [19,5] | [27,4] | [27,5] |
|    T15     | [3,6] | [3,7] | [11,6] | [11,7] | [19,6] | [19,7] | [27,6] | [27,7] |
|    T16     | [4,0] | [4,1] | [12,0] | [12,1] | [20,0] | [20,1] | [28,0] | [28,1] |
|    T17     | [4,2] | [4,3] | [12,2] | [12,3] | [20,2] | [20,3] | [28,2] | [28,3] |
|    T18     | [4,4] | [4,5] | [12,4] | [12,5] | [20,4] | [20,5] | [28,4] | [28,5] |
|    T19     | [4,6] | [4,7] | [12,6] | [12,7] | [20,6] | [20,7] | [28,6] | [28,7] |
|    T20     | [5,0] | [5,1] | [13,0] | [13,1] | [21,0] | [21,1] | [29,0] | [29,1] |
|    T21     | [5,2] | [5,3] | [13,2] | [13,3] | [21,2] | [21,3] | [29,2] | [29,3] |
|    T22     | [5,4] | [5,5] | [13,4] | [13,5] | [21,4] | [21,5] | [29,4] | [29,5] |
|    T23     | [5,6] | [5,7] | [13,6] | [13,7] | [21,6] | [21,7] | [29,6] | [29,7] |
|    T24     | [6,0] | [6,1] | [14,0] | [14,1] | [22,0] | [22,1] | [30,0] | [30,1] |
|    T25     | [6,2] | [6,3] | [14,2] | [14,3] | [22,2] | [22,3] | [30,2] | [30,3] |
|    T26     | [6,4] | [6,5] | [14,4] | [14,5] | [22,4] | [22,5] | [30,4] | [30,5] |
|    T27     | [6,6] | [6,7] | [14,6] | [14,7] | [22,6] | [22,7] | [30,6] | [30,7] |
|    T28     | [7,0] | [7,1] | [15,0] | [15,1] | [23,0] | [23,1] | [31,0] | [31,1] |
|    T29     | [7,2] | [7,3] | [15,2] | [15,3] | [23,2] | [23,3] | [31,2] | [31,3] |
|    T30     | [7,4] | [7,5] | [15,4] | [15,5] | [23,4] | [23,5] | [31,4] | [31,5] |
|    T31     | [7,6] | [7,7] | [15,6] | [15,7] | [23,6] | [23,7] | [31,6] | [31,7] |

#### M = 8, N = 32, K = 16

##### Matrix A (8×16) (FP16):

|   | 0   | 1   | 2   | 3   | 4   | 5   | 6   | 7   | 8   | 9   | 10  | 11  | 12  | 13  | 14  | 15  |
|---|-----|-----|-----|-----|-----|-----|-----|-----|-----|-----|-----|-----|-----|-----|-----|-----|
| 0 | 0   | 1   | 2   | 3   | 4   | 5   | 6   | 7   | 8   | 9   | 10  | 11  | 12  | 13  | 14  | 15  |
| 1 | 16  | 17  | 18  | 19  | 20  | 21  | 22  | 23  | 24  | 25  | 26  | 27  | 28  | 29  | 30  | 31  |
| 2 | 32  | 33  | 34  | 35  | 36  | 37  | 38  | 39  | 40  | 41  | 42  | 43  | 44  | 45  | 46  | 47  |
| 3 | 48  | 49  | 50  | 51  | 52  | 53  | 54  | 55  | 56  | 57  | 58  | 59  | 60  | 61  | 62  | 63  |
| 4 | 64  | 65  | 66  | 67  | 68  | 69  | 70  | 71  | 72  | 73  | 74  | 75  | 76  | 77  | 78  | 79  |
| 5 | 80  | 81  | 82  | 83  | 84  | 85  | 86  | 87  | 88  | 89  | 90  | 91  | 92  | 93  | 94  | 95  |
| 6 | 96  | 97  | 98  | 99  | 100 | 101 | 102 | 103 | 104 | 105 | 106 | 107 | 108 | 109 | 110 | 111 |
| 7 | 112 | 113 | 114 | 115 | 116 | 117 | 118 | 119 | 120 | 121 | 122 | 123 | 124 | 125 | 126 | 127 |

##### Matrix B (16×32) (FP16):

|    | 0   | 1   | 2   | 3   | 4   | 5   | 6   | 7   | 8   | 9   | 10  | 11  | 12  | 13  | 14  | 15  | 16  | 17  | 18  | 19  | 20  | 21  | 22  | 23  | 24  | 25  | 26  | 27  | 28  | 29  | 30  | 31  |
|----|-----|-----|-----|-----|-----|-----|-----|-----|-----|-----|-----|-----|-----|-----|-----|-----|-----|-----|-----|-----|-----|-----|-----|-----|-----|-----|-----|-----|-----|-----|-----|-----|
| 0  | 0   | 1   | 2   | 3   | 4   | 5   | 6   | 7   | 8   | 9   | 10  | 11  | 12  | 13  | 14  | 15  | 16  | 17  | 18  | 19  | 20  | 21  | 22  | 23  | 24  | 25  | 26  | 27  | 28  | 29  | 30  | 31  |
| 1  | 32  | 33  | 34  | 35  | 36  | 37  | 38  | 39  | 40  | 41  | 42  | 43  | 44  | 45  | 46  | 47  | 48  | 49  | 50  | 51  | 52  | 53  | 54  | 55  | 56  | 57  | 58  | 59  | 60  | 61  | 62  | 63  |
| 2  | 64  | 65  | 66  | 67  | 68  | 69  | 70  | 71  | 72  | 73  | 74  | 75  | 76  | 77  | 78  | 79  | 80  | 81  | 82  | 83  | 84  | 85  | 86  | 87  | 88  | 89  | 90  | 91  | 92  | 93  | 94  | 95  |
| 3  | 96  | 97  | 98  | 99  | 100 | 101 | 102 | 103 | 104 | 105 | 106 | 107 | 108 | 109 | 110 | 111 | 112 | 113 | 114 | 115 | 116 | 117 | 118 | 119 | 120 | 121 | 122 | 123 | 124 | 125 | 126 | 127 |
| 4  | 128 | 129 | 130 | 131 | 132 | 133 | 134 | 135 | 136 | 137 | 138 | 139 | 140 | 141 | 142 | 143 | 144 | 145 | 146 | 147 | 148 | 149 | 150 | 151 | 152 | 153 | 154 | 155 | 156 | 157 | 158 | 159 |
| 5  | 160 | 161 | 162 | 163 | 164 | 165 | 166 | 167 | 168 | 169 | 170 | 171 | 172 | 173 | 174 | 175 | 176 | 177 | 178 | 179 | 180 | 181 | 182 | 183 | 184 | 185 | 186 | 187 | 188 | 189 | 190 | 191 |
| 6  | 192 | 193 | 194 | 195 | 196 | 197 | 198 | 199 | 200 | 201 | 202 | 203 | 204 | 205 | 206 | 207 | 208 | 209 | 210 | 211 | 212 | 213 | 214 | 215 | 216 | 217 | 218 | 219 | 220 | 221 | 222 | 223 |
| 7  | 224 | 225 | 226 | 227 | 228 | 229 | 230 | 231 | 232 | 233 | 234 | 235 | 236 | 237 | 238 | 239 | 240 | 241 | 242 | 243 | 244 | 245 | 246 | 247 | 248 | 249 | 250 | 251 | 252 | 253 | 254 | 255 |
| 8  | 256 | 257 | 258 | 259 | 260 | 261 | 262 | 263 | 264 | 265 | 266 | 267 | 268 | 269 | 270 | 271 | 272 | 273 | 274 | 275 | 276 | 277 | 278 | 279 | 280 | 281 | 282 | 283 | 284 | 285 | 286 | 287 |
| 9  | 288 | 289 | 290 | 291 | 292 | 293 | 294 | 295 | 296 | 297 | 298 | 299 | 300 | 301 | 302 | 303 | 304 | 305 | 306 | 307 | 308 | 309 | 310 | 311 | 312 | 313 | 314 | 315 | 316 | 317 | 318 | 319 |
| 10 | 320 | 321 | 322 | 323 | 324 | 325 | 326 | 327 | 328 | 329 | 330 | 331 | 332 | 333 | 334 | 335 | 336 | 337 | 338 | 339 | 340 | 341 | 342 | 343 | 344 | 345 | 346 | 347 | 348 | 349 | 350 | 351 |
| 11 | 352 | 353 | 354 | 355 | 356 | 357 | 358 | 359 | 360 | 361 | 362 | 363 | 364 | 365 | 366 | 367 | 368 | 369 | 370 | 371 | 372 | 373 | 374 | 375 | 376 | 377 | 378 | 379 | 380 | 381 | 382 | 383 |
| 12 | 384 | 385 | 386 | 387 | 388 | 389 | 390 | 391 | 392 | 393 | 394 | 395 | 396 | 397 | 398 | 399 | 400 | 401 | 402 | 403 | 404 | 405 | 406 | 407 | 408 | 409 | 410 | 411 | 412 | 413 | 414 | 415 |
| 13 | 416 | 417 | 418 | 419 | 420 | 421 | 422 | 423 | 424 | 425 | 426 | 427 | 428 | 429 | 430 | 431 | 432 | 433 | 434 | 435 | 436 | 437 | 438 | 439 | 440 | 441 | 442 | 443 | 444 | 445 | 446 | 447 |
| 14 | 448 | 449 | 450 | 451 | 452 | 453 | 454 | 455 | 456 | 457 | 458 | 459 | 460 | 461 | 462 | 463 | 464 | 465 | 466 | 467 | 468 | 469 | 470 | 471 | 472 | 473 | 474 | 475 | 476 | 477 | 478 | 479 |
| 15 | 480 | 481 | 482 | 483 | 484 | 485 | 486 | 487 | 488 | 489 | 490 | 491 | 492 | 493 | 494 | 495 | 496 | 497 | 498 | 499 | 500 | 501 | 502 | 503 | 504 | 505 | 506 | 507 | 508 | 509 | 510 | 511 |

##### Matrix C (8×32) (FP32):

|   | 0      | 1      | 2      | 3      | 4      | 5      | 6      | 7      | 8      | 9      | 10     | 11     | 12     | 13     | 14     | 15     | 16     | 17     | 18     | 19     | 20     | 21     | 22     | 23     | 24     | 25     | 26     | 27     | 28     | 29     | 30     | 31     |
|---|--------|--------|--------|--------|--------|--------|--------|--------|--------|--------|--------|--------|--------|--------|--------|--------|--------|--------|--------|--------|--------|--------|--------|--------|--------|--------|--------|--------|--------|--------|--------|--------|
| 0 | 39680  | 39800  | 39920  | 40040  | 40160  | 40280  | 40400  | 40520  | 40640  | 40760  | 40880  | 41000  | 41120  | 41240  | 41360  | 41480  | 41600  | 41720  | 41840  | 41960  | 42080  | 42200  | 42320  | 42440  | 42560  | 42680  | 42800  | 42920  | 43040  | 43160  | 43280  | 43400  |
| 1 | 101120 | 101496 | 101872 | 102248 | 102624 | 103000 | 103376 | 103752 | 104128 | 104504 | 104880 | 105256 | 105632 | 106008 | 106384 | 106760 | 107136 | 107512 | 107888 | 108264 | 108640 | 109016 | 109392 | 109768 | 110144 | 110520 | 110896 | 111272 | 111648 | 112024 | 112400 | 112776 |
| 2 | 162560 | 163192 | 163824 | 164456 | 165088 | 165720 | 166352 | 166984 | 167616 | 168248 | 168880 | 169512 | 170144 | 170776 | 171408 | 172040 | 172672 | 173304 | 173936 | 174568 | 175200 | 175832 | 176464 | 177096 | 177728 | 178360 | 178992 | 179624 | 180256 | 180888 | 181520 | 182152 |
| 3 | 224000 | 224888 | 225776 | 226664 | 227552 | 228440 | 229328 | 230216 | 231104 | 231992 | 232880 | 233768 | 234656 | 235544 | 236432 | 237320 | 238208 | 239096 | 239984 | 240872 | 241760 | 242648 | 243536 | 244424 | 245312 | 246200 | 247088 | 247976 | 248864 | 249752 | 250640 | 251528 |
| 4 | 285440 | 286584 | 287728 | 288872 | 290016 | 291160 | 292304 | 293448 | 294592 | 295736 | 296880 | 298024 | 299168 | 300312 | 301456 | 302600 | 303744 | 304888 | 306032 | 307176 | 308320 | 309464 | 310608 | 311752 | 312896 | 314040 | 315184 | 316328 | 317472 | 318616 | 319760 | 320904 |
| 5 | 346880 | 348280 | 349680 | 351080 | 352480 | 353880 | 355280 | 356680 | 358080 | 359480 | 360880 | 362280 | 363680 | 365080 | 366480 | 367880 | 369280 | 370680 | 372080 | 373480 | 374880 | 376280 | 377680 | 379080 | 380480 | 381880 | 383280 | 384680 | 386080 | 387480 | 388880 | 390280 |
| 6 | 408320 | 409976 | 411632 | 413288 | 414944 | 416600 | 418256 | 419912 | 421568 | 423224 | 424880 | 426536 | 428192 | 429848 | 431504 | 433160 | 434816 | 436472 | 438128 | 439784 | 441440 | 443096 | 444752 | 446408 | 448064 | 449720 | 451376 | 453032 | 454688 | 456344 | 458000 | 459656 |
| 7 | 469760 | 471672 | 473584 | 475496 | 477408 | 479320 | 481232 | 483144 | 485056 | 486968 | 488880 | 490792 | 492704 | 494616 | 496528 | 498440 | 500352 | 502264 | 504176 | 506088 | 508000 | 509912 | 511824 | 513736 | 515648 | 517560 | 519472 | 521384 | 523296 | 525208 | 527120 | 529032 |

##### warp 中每个线程实际储存的数据

| landId\idx |   0    |   1    |   2    |   3    |   4    |   5    |   6    |   7    |
|:----------:|:------:|:------:|:------:|:------:|:------:|:------:|:------:|:------:|
|     T0     | 39680  | 101120 | 40640  | 104128 | 41600  | 107136 | 42560  | 110144 |
|     T1     | 162560 | 224000 | 167616 | 231104 | 172672 | 238208 | 177728 | 245312 |
|     T2     | 285440 | 346880 | 294592 | 358080 | 303744 | 369280 | 312896 | 380480 |
|     T3     | 408320 | 469760 | 421568 | 485056 | 434816 | 500352 | 448064 | 515648 |
|     T4     | 39800  | 101496 | 40760  | 104504 | 41720  | 107512 | 42680  | 110520 |
|     T5     | 163192 | 224888 | 168248 | 231992 | 173304 | 239096 | 178360 | 246200 |
|     T6     | 286584 | 348280 | 295736 | 359480 | 304888 | 370680 | 314040 | 381880 |
|     T7     | 409976 | 471672 | 423224 | 486968 | 436472 | 502264 | 449720 | 517560 |
|     T8     | 39920  | 101872 | 40880  | 104880 | 41840  | 107888 | 42800  | 110896 |
|     T9     | 163824 | 225776 | 168880 | 232880 | 173936 | 239984 | 178992 | 247088 |
|    T10     | 287728 | 349680 | 296880 | 360880 | 306032 | 372080 | 315184 | 383280 |
|    T11     | 411632 | 473584 | 424880 | 488880 | 438128 | 504176 | 451376 | 519472 |
|    T12     | 40040  | 102248 | 41000  | 105256 | 41960  | 108264 | 42920  | 111272 |
|    T13     | 164456 | 226664 | 169512 | 233768 | 174568 | 240872 | 179624 | 247976 |
|    T14     | 288872 | 351080 | 298024 | 362280 | 307176 | 373480 | 316328 | 384680 |
|    T15     | 413288 | 475496 | 426536 | 490792 | 439784 | 506088 | 453032 | 521384 |
|    T16     | 40160  | 102624 | 41120  | 105632 | 42080  | 108640 | 43040  | 111648 |
|    T17     | 165088 | 227552 | 170144 | 234656 | 175200 | 241760 | 180256 | 248864 |
|    T18     | 290016 | 352480 | 299168 | 363680 | 308320 | 374880 | 317472 | 386080 |
|    T19     | 414944 | 477408 | 428192 | 492704 | 441440 | 508000 | 454688 | 523296 |
|    T20     | 40280  | 103000 | 41240  | 106008 | 42200  | 109016 | 43160  | 112024 |
|    T21     | 165720 | 228440 | 170776 | 235544 | 175832 | 242648 | 180888 | 249752 |
|    T22     | 291160 | 353880 | 300312 | 365080 | 309464 | 376280 | 318616 | 387480 |
|    T23     | 416600 | 479320 | 429848 | 494616 | 443096 | 509912 | 456344 | 525208 |
|    T24     | 40400  | 103376 | 41360  | 106384 | 42320  | 109392 | 43280  | 112400 |
|    T25     | 166352 | 229328 | 171408 | 236432 | 176464 | 243536 | 181520 | 250640 |
|    T26     | 292304 | 355280 | 301456 | 366480 | 310608 | 377680 | 319760 | 388880 |
|    T27     | 418256 | 481232 | 431504 | 496528 | 444752 | 511824 | 458000 | 527120 |
|    T28     | 40520  | 103752 | 41480  | 106760 | 42440  | 109768 | 43400  | 112776 |
|    T29     | 166984 | 230216 | 172040 | 237320 | 177096 | 244424 | 182152 | 251528 |
|    T30     | 293448 | 356680 | 302600 | 367880 | 311752 | 379080 | 320904 | 390280 |
|    T31     | 419912 | 483144 | 433160 | 498440 | 446408 | 513736 | 459656 | 529032 |

##### 整理后对应的列表:

| landId\idx |   0   |   1   |   2    |   3    |   4    |   5    |   6    |   7    |
|:----------:|:-----:|:-----:|:------:|:------:|:------:|:------:|:------:|:------:|
|     T0     | [0,0] | [1,0] | [0,8]  | [1,8]  | [0,16] | [1,16] | [0,24] | [1,24] |
|     T1     | [2,0] | [3,0] | [2,8]  | [3,8]  | [2,16] | [3,16] | [2,24] | [3,24] |
|     T2     | [4,0] | [5,0] | [4,8]  | [5,8]  | [4,16] | [5,16] | [4,24] | [5,24] |
|     T3     | [6,0] | [7,0] | [6,8]  | [7,8]  | [6,16] | [7,16] | [6,24] | [7,24] |
|     T4     | [0,1] | [1,1] | [0,9]  | [1,9]  | [0,17] | [1,17] | [0,25] | [1,25] |
|     T5     | [2,1] | [3,1] | [2,9]  | [3,9]  | [2,17] | [3,17] | [2,25] | [3,25] |
|     T6     | [4,1] | [5,1] | [4,9]  | [5,9]  | [4,17] | [5,17] | [4,25] | [5,25] |
|     T7     | [6,1] | [7,1] | [6,9]  | [7,9]  | [6,17] | [7,17] | [6,25] | [7,25] |
|     T8     | [0,2] | [1,2] | [0,10] | [1,10] | [0,18] | [1,18] | [0,26] | [1,26] |
|     T9     | [2,2] | [3,2] | [2,10] | [3,10] | [2,18] | [3,18] | [2,26] | [3,26] |
|    T10     | [4,2] | [5,2] | [4,10] | [5,10] | [4,18] | [5,18] | [4,26] | [5,26] |
|    T11     | [6,2] | [7,2] | [6,10] | [7,10] | [6,18] | [7,18] | [6,26] | [7,26] |
|    T12     | [0,3] | [1,3] | [0,11] | [1,11] | [0,19] | [1,19] | [0,27] | [1,27] |
|    T13     | [2,3] | [3,3] | [2,11] | [3,11] | [2,19] | [3,19] | [2,27] | [3,27] |
|    T14     | [4,3] | [5,3] | [4,11] | [5,11] | [4,19] | [5,19] | [4,27] | [5,27] |
|    T15     | [6,3] | [7,3] | [6,11] | [7,11] | [6,19] | [7,19] | [6,27] | [7,27] |
|    T16     | [0,4] | [1,4] | [0,12] | [1,12] | [0,20] | [1,20] | [0,28] | [1,28] |
|    T17     | [2,4] | [3,4] | [2,12] | [3,12] | [2,20] | [3,20] | [2,28] | [3,28] |
|    T18     | [4,4] | [5,4] | [4,12] | [5,12] | [4,20] | [5,20] | [4,28] | [5,28] |
|    T19     | [6,4] | [7,4] | [6,12] | [7,12] | [6,20] | [7,20] | [6,28] | [7,28] |
|    T20     | [0,5] | [1,5] | [0,13] | [1,13] | [0,21] | [1,21] | [0,29] | [1,29] |
|    T21     | [2,5] | [3,5] | [2,13] | [3,13] | [2,21] | [3,21] | [2,29] | [3,29] |
|    T22     | [4,5] | [5,5] | [4,13] | [5,13] | [4,21] | [5,21] | [4,29] | [5,29] |
|    T23     | [6,5] | [7,5] | [6,13] | [7,13] | [6,21] | [7,21] | [6,29] | [7,29] |
|    T24     | [0,6] | [1,6] | [0,14] | [1,14] | [0,22] | [1,22] | [0,30] | [1,30] |
|    T25     | [2,6] | [3,6] | [2,14] | [3,14] | [2,22] | [3,22] | [2,30] | [3,30] |
|    T26     | [4,6] | [5,6] | [4,14] | [5,14] | [4,22] | [5,22] | [4,30] | [5,30] |
|    T27     | [6,6] | [7,6] | [6,14] | [7,14] | [6,22] | [7,22] | [6,30] | [7,30] |
|    T28     | [0,7] | [1,7] | [0,15] | [1,15] | [0,23] | [1,23] | [0,31] | [1,31] |
|    T29     | [2,7] | [3,7] | [2,15] | [3,15] | [2,23] | [3,23] | [2,31] | [3,31] |
|    T30     | [4,7] | [5,7] | [4,15] | [5,15] | [4,23] | [5,23] | [4,31] | [5,31] |
|    T31     | [6,7] | [7,7] | [6,15] | [7,15] | [6,23] | [7,23] | [6,31] | [7,31] |

---

### 使用COO格式储存稀疏矩阵进行运算(第一版)

#### 测试结果 行主序储存 16×16×16

- GPU : 4090
- Debug build
- matrixA(half) : row_major, matrixB(half) : row_major, matrixP(float) : row_major
- WMMA : 16 × 16 × 16

| GPU:4090, debug build, row_major,16×16×16                            | sddmm_isratnisa | sddmm_zcx  |
|----------------------------------------------------------------------|-----------------|------------|
| M : 3000, N : 7000, K : 256, nnz : 313110, sparsity : 98.51%         | 0.508448 ms     | 642.824 ms |
| M : 2000, N : 12000, K : 256, nnz : 746000, sparsity : 96.8917%      | 1.59091 ms      | 1735.09 ms |
| M : 300000, N : 103000, K : 256, nnz : 69000000, sparsity : 99.7767% | 26.6559 ms      |            |
| M : 35000, N : 35000, K : 256, nnz : 422000, sparsity : 99.9656%     | 0.237888 ms     |            |
| M : 549000, N : 549000, K : 256, nnz : 926000, sparsity : 99.9997%   | 2.61411 ms      |            |
| M : 426000, N : 426000, K : 256, nnz : 1000000, sparsity : 99.9995%  | 2.41718 ms      |            |
| M : 37000, N : 37000, K : 256, nnz : 368000, sparsity : 99.9731%     | 0.234112 ms     | 47499.1 ms |
| M : 4000, N : 4000, K : 256, nnz : 88000, sparsity : 99.45%          | 0.172064 ms     |            |
| M : 106000, N : 106000, K : 256, nnz : 3000000, sparsity : 99.9733%  | 1.97805 ms      |            |
| M : 685000, N : 685000, K : 256, nnz : 8000000, sparsity : 99.9983%  | 12.3796 ms      |            |
| M : 916000, N : 916000, K : 256, nnz : 5000000, sparsity : 99.9994%  | 9.60342 ms      |            |
| M : 326000, N : 326000, K : 256, nnz : 1000000, sparsity : 99.9991%  | 2.11952 ms      |            |
| M : 197000, N : 197000, K : 256, nnz : 2000000, sparsity : 99.9948%  | 2.10243 ms      |            |
| M : 390000, N : 390000, K : 256, nnz : 2000000, sparsity : 99.9987%  | 3.45181 ms      |            |
| M : 260000, N : 260000, K : 256, nnz : 4000000, sparsity : 99.9941%  | 4.01792 ms      |            |
| M : 241000, N : 241000, K : 256, nnz : 561000, sparsity : 99.999%    | 1.28944 ms      |            |
| M : 36000, N : 36000, K : 256, nnz : 4000000, sparsity : 99.6914%    | 1.33123 ms      |            |

太大的矩阵还是不能计算, 应该是时间太久了, 需要继续优化. 目前先针对 `matrixTileMultiplicationUseTensorCore2()`
函数中 `for` 循环的次数来优化.

```c++
for (int matrixPIdx = 0; matrixPIdx < nnz; ++matrixPIdx) {
    const size_t curRow = matrixSRowIndex[matrixPIdx];
    const size_t curCol = matrixSColIndex[matrixPIdx];

    int findLaneId, findIdx;
    positionCalculator(pRowId, pColId, curRow, curCol, findLaneId, findIdx);

    if (laneId == findLaneId) {
    matrixP[matrixPIdx] = cFrag.x[findIdx];
    }
}
```

---

### 使用COO格式储存稀疏矩阵进行运算(第二版)

针对 `for (int matrixPIdx = 0; matrixPIdx < nnz; ++matrixPIdx)` 循环进行了优化,
现在是 `for (int matrixPIdx = matrixTileIndex[warpId]; matrixPIdx < matrixTileIndex[warpId + 1]; ++matrixPIdx)`

#### 测试结果 行主序储存 16×16×16

- GPU : 4090
- Release build
- matrixA(half) : row_major, matrixB(half) : row_major, matrixP(float) : row_major
- WMMA : 16 × 16 × 16

| M = 5000, N = 5000, k = 256 | sparsity | isratnisa_sddmm | zcx_sddmm | isratnisa_other | zcx_other | isratnisa | zcx     |
|-----------------------------|----------|-----------------|-----------|-----------------|-----------|-----------|---------|
| matrix_5000_5000_1250000    | 95%      | 1.09066         | 0.299328  | 14.4353         | 161.652   | 15.526    | 161.951 |
| matrix_5000_5000_1000000    | 96%      | 0.889664        | 0.29328   | 10.966          | 129.538   | 11.8574   | 129.831 |
| matrix_5000_5000_750000     | 97%      | 0.699264        | 0.283808  | 5.72211         | 97.0118   | 6.42138   | 97.2956 |
| matrix_5000_5000_500000     | 98%      | 0.490336        | 0.273024  | 3.36794         | 64.8893   | 3.85827   | 65.1624 |
| matrix_5000_5000_250000     | 99%      | 0.299968        | 0.260736  | 1.40698         | 32.4087   | 1.70694   | 32.6694 |
| matrix_5000_5000_125000     | 99.5%    | 0.263104        | 0.2048    | 1.02298         | 25.0018   | 1.28608   | 25.2066 |
| matrix_5000_5000_100000     | 99.6%    | 0.230624        | 0.179552  | 0.772224        | 21.3993   | 1.00285   | 21.5789 |
| matrix_5000_5000_75000      | 99.7%    | 0.21088         | 0.160448  | 0.585856        | 18.2028   | 0.796736  | 18.3632 |
| matrix_5000_5000_50000      | 99.8%    | 0.177344        | 0.140288  | 0.41792         | 14.9282   | 0.595264  | 15.0685 |
| matrix_5000_5000_25000      | 99.9%    | 0.155872        | 0.125984  | 0.238592        | 11.7914   | 0.394464  | 11.9173 |

| M = 10000, N = 10000, k = 256 | sparsity | isratnisa_sddmm | zcx_sddmm | isratnisa_other | zcx_other | isratnisa | zcx     |
|-------------------------------|----------|-----------------|-----------|-----------------|-----------|-----------|---------|
| matrix_10000_10000_5000000    | 95%      | 2.22109         | 1.02646   | 42.8288         | 1860.13   | 45.0571   | 1861.15 | 
| matrix_10000_10000_4000000    | 96%      | 1.75302         | 1.00064   | 35.4837         | 1485.79   | 37.2458   | 1486.79 |
| matrix_10000_10000_3000000    | 97%      | 1.33178         | 0.981952  | 26.5841         | 1114.52   | 27.9226   | 1115.5  |
| matrix_10000_10000_2000000    | 98%      | 0.922496        | 0.958176  | 18.8662         | 751.235   | 19.7887   | 752.193 |
| matrix_10000_10000_1000000    | 99%      | 0.504608        | 0.881696  | 5.77741         | 374.57    | 6.28202   | 375.452 | 

| M = 50000, N = 50000, k = 256 | sparsity | isratnisa_sddmm | zcx_sddmm | isratnisa_other | zcx_other | isratnisa | zcx    |
|-------------------------------|----------|-----------------|-----------|-----------------|-----------|-----------|--------|
| matrix_50000_50000_125000000  | 95%      | 47.681          | 25.3338   | 1642.71         |           | 1690.39   |        | 
| matrix_50000_50000_100000000  | 96%      | 38.7035         | 24.9057   | 1299.05         |           | 1337.75   |        | 
| matrix_50000_50000_75000000   | 97%      | 29.3539         | 24.4852   | 980.465         | 768576    | 1009.82   | 768600 | 
| matrix_50000_50000_50000000   | 98%      | 19.8487         | 24.0033   | 648.781         | 509691    | 668.629   | 509715 | 
| matrix_50000_50000_25000000   | 99%      | 10.4242         | 22.1125   | 323.567         | 255493    | 333.991   | 255515 |  

---

### 在上一版的基础上优化整理数据的函数(openTensorCoreModeForSampled())

#### 使用共享内存: pipelining方法.

一个线程计算一个warp中的.

##### 测试结果 16×16×16 行主序储存

###### matrix 5000 5000

- GPU : 4090
- Release build
- matrixA(half) : row_major, matrixB(half) : row_major, matrixP(float) : row_major
- WMMA : 16×16×16

|                         | sparsity | k    | isratnisa_sddmm | zcx_sddmm | isratnisa_other | zcx_other | isratnisa | zcx   |
|-------------------------|----------|------|-----------------|-----------|-----------------|-----------|-----------|-------|
| matrix_5000_5000_125000 | 99.50%   | 5000 | 3.53            | 3.88      | 2.27            | 10.84     | 5.80      | 14.72 |
| matrix_5000_5000_125000 | 99.50%   | 4000 | 2.71            | 3.05      | 2.26            | 10.83     | 4.97      | 13.88 |
| matrix_5000_5000_125000 | 99.50%   | 3000 | 2.14            | 2.26      | 2.38            | 10.83     | 4.53      | 13.09 |
| matrix_5000_5000_125000 | 99.50%   | 2000 | 1.50            | 1.34      | 2.28            | 10.84     | 3.78      | 12.18 |
| matrix_5000_5000_125000 | 99.50%   | 1000 | 0.74            | 0.63      | 1.83            | 10.84     | 2.58      | 11.48 |
| matrix_5000_5000_125000 | 99.50%   | 500  | 0.44            | 0.38      | 2.68            | 10.83     | 3.12      | 11.21 |
| matrix_5000_5000_125000 | 99.50%   | 256  | 0.25            | 0.21      | 2.27            | 10.84     | 2.52      | 11.05 |

|                         | sparsity | k    | isratnisa_sddmm | zcx_sddmm | isratnisa_other | zcx_other | isratnisa | zcx   |
|-------------------------|----------|------|-----------------|-----------|-----------------|-----------|-----------|-------|
| matrix_5000_5000_100000 | 99.60%   | 5000 | 3.14            | 3.62      | 2.77            | 9.19      | 5.91      | 12.81 |
| matrix_5000_5000_100000 | 99.60%   | 4000 | 2.40            | 2.84      | 1.88            | 9.24      | 4.28      | 12.07 |
| matrix_5000_5000_100000 | 99.60%   | 3000 | 1.87            | 2.09      | 1.87            | 9.18      | 3.74      | 11.27 |
| matrix_5000_5000_100000 | 99.60%   | 2000 | 1.32            | 1.24      | 1.86            | 9.24      | 3.18      | 10.48 |
| matrix_5000_5000_100000 | 99.60%   | 1000 | 0.67            | 0.59      | 1.52            | 9.22      | 2.19      | 9.82  |
| matrix_5000_5000_100000 | 99.60%   | 500  | 0.40            | 0.35      | 1.89            | 9.21      | 2.29      | 9.56  |
| matrix_5000_5000_100000 | 99.60%   | 256  | 0.23            | 0.19      | 1.93            | 9.28      | 2.15      | 9.47  |

|                        | sparsity | k    | isratnisa_sddmm | zcx_sddmm | isratnisa_other | zcx_other | isratnisa | zcx   |
|------------------------|----------|------|-----------------|-----------|-----------------|-----------|-----------|-------|
| matrix_5000_5000_75000 | 99.70%   | 5000 | 2.68            | 3.44      | 1.50            | 7.25      | 4.19      | 10.69 |
| matrix_5000_5000_75000 | 99.70%   | 4000 | 2.08            | 2.60      | 1.49            | 7.21      | 3.57      | 9.81  |
| matrix_5000_5000_75000 | 99.70%   | 3000 | 1.62            | 1.92      | 1.43            | 7.19      | 3.05      | 9.11  |
| matrix_5000_5000_75000 | 99.70%   | 2000 | 1.14            | 1.19      | 1.48            | 7.25      | 2.61      | 8.44  |
| matrix_5000_5000_75000 | 99.70%   | 1000 | 0.57            | 0.57      | 1.16            | 7.19      | 1.73      | 7.76  |
| matrix_5000_5000_75000 | 99.70%   | 500  | 0.35            | 0.31      | 1.68            | 7.23      | 2.03      | 7.53  |
| matrix_5000_5000_75000 | 99.70%   | 256  | 0.21            | 0.17      | 1.47            | 7.19      | 1.68      | 7.36  |

|                        | sparsity | k    | isratnisa_sddmm | zcx_sddmm | isratnisa_other | zcx_other | isratnisa | zcx  |
|------------------------|----------|------|-----------------|-----------|-----------------|-----------|-----------|------|
| matrix_5000_5000_50000 | 99.80%   | 256  | 0.17            | 0.16      | 1.03            | 5.31      | 1.19      | 5.46 |
| matrix_5000_5000_50000 | 99.80%   | 500  | 0.29            | 0.27      | 1.06            | 5.27      | 1.36      | 5.54 |
| matrix_5000_5000_50000 | 99.80%   | 1000 | 0.48            | 0.52      | 0.85            | 5.29      | 1.33      | 5.81 |
| matrix_5000_5000_50000 | 99.80%   | 2000 | 0.96            | 1.09      | 1.61            | 5.23      | 2.57      | 6.32 |
| matrix_5000_5000_50000 | 99.80%   | 3000 | 1.36            | 1.69      | 1.10            | 5.27      | 2.46      | 6.96 |
| matrix_5000_5000_50000 | 99.80%   | 4000 | 1.73            | 2.27      | 1.59            | 5.24      | 3.32      | 7.51 |
| matrix_5000_5000_50000 | 99.80%   | 5000 | 2.27            | 3.02      | 1.06            | 5.22      | 3.32      | 8.24 |

|                        | sparsity | k    | isratnisa_sddmm | zcx_sddmm | isratnisa_other | zcx_other | isratnisa | zcx  |
|------------------------|----------|------|-----------------|-----------|-----------------|-----------|-----------|------|
| matrix_5000_5000_25000 | 99.90%   | 5000 | 1.79            | 2.16      | 0.57            | 3.36      | 2.36      | 5.52 |
| matrix_5000_5000_25000 | 99.90%   | 4000 | 1.40            | 1.65      | 0.58            | 3.42      | 1.98      | 5.07 |
| matrix_5000_5000_25000 | 99.90%   | 3000 | 1.12            | 1.22      | 0.66            | 3.34      | 1.78      | 4.56 |
| matrix_5000_5000_25000 | 99.90%   | 2000 | 0.76            | 0.81      | 0.60            | 3.36      | 1.35      | 4.17 |
| matrix_5000_5000_25000 | 99.90%   | 1000 | 0.40            | 0.41      | 0.50            | 3.35      | 0.90      | 3.75 |
| matrix_5000_5000_25000 | 99.90%   | 500  | 0.26            | 0.20      | 0.61            | 3.38      | 0.87      | 3.58 |
| matrix_5000_5000_25000 | 99.90%   | 256  | 0.16            | 0.12      | 0.62            | 3.37      | 0.78      | 3.49 |

|                       | sparsity | k    | isratnisa_sddmm | zcx_sddmm | isratnisa_other | zcx_other | isratnisa | zcx  |
|-----------------------|----------|------|-----------------|-----------|-----------------|-----------|-----------|------|
| matrix_5000_5000_2500 | 99.99%   | 256  | 0.15            | 0.04      | 0.13            | 1.70      | 0.28      | 1.74 |
| matrix_5000_5000_2500 | 99.99%   | 500  | 0.25            | 0.06      | 0.12            | 1.73      | 0.37      | 1.78 |
| matrix_5000_5000_2500 | 99.99%   | 1000 | 0.34            | 0.09      | 0.11            | 1.69      | 0.45      | 1.78 |
| matrix_5000_5000_2500 | 99.99%   | 2000 | 0.61            | 0.16      | 0.13            | 1.66      | 0.74      | 1.82 |
| matrix_5000_5000_2500 | 99.99%   | 3000 | 0.83            | 0.28      | 0.12            | 1.64      | 0.96      | 1.92 |
| matrix_5000_5000_2500 | 99.99%   | 4000 | 1.07            | 0.37      | 0.20            | 1.63      | 1.26      | 2.00 |
| matrix_5000_5000_2500 | 99.99%   | 5000 | 1.33            | 0.57      | 0.12            | 1.65      | 1.46      | 2.22 |

###### matrix 10000 10000

- GPU : 4090
- Release build
- matrixA(half) : row_major, matrixB(half) : row_major, matrixP(float) : row_major
- WMMA : 16×16×16

|                            | sparsity | k    | isratnisa_sddmm | zcx_sddmm | isratnisa_other | zcx_other | isratnisa | zcx     |
|----------------------------|----------|------|-----------------|-----------|-----------------|-----------|-----------|---------|
| matrix_10000_10000_5000000 | 95.00%   | 256  | 2.30            | 0.96      | 102.21          | 1269.67   | 104.51    | 1270.64 |NO PASS numError = 45
| matrix_10000_10000_5000000 | 95.00%   | 500  | 4.92            | 1.96      | 99.37           | 1270.01   | 104.29    | 1271.97 |
| matrix_10000_10000_5000000 | 95.00%   | 1000 | 9.81            | 2.94      | 98.18           | 1272.45   | 107.99    | 1275.39 |
| matrix_10000_10000_5000000 | 95.00%   | 2000 | 19.48           | 6.46      | 97.84           | 1277.37   | 117.32    | 1283.84 |
| matrix_10000_10000_5000000 | 95.00%   | 3000 | 29.26           | 11.65     | 100.63          | 1277.31   | 129.89    | 1288.96 |
| matrix_10000_10000_5000000 | 95.00%   | 4000 | 36.99           | 13.20     | 99.54           | 1269.64   | 136.53    | 1282.84 |
| matrix_10000_10000_5000000 | 95.00%   | 5000 | 51.37           | 19.28     | 101.23          | 1264.57   | 152.60    | 1283.85 |

|                            | sparsity | k    | isratnisa_sddmm | zcx_sddmm | isratnisa_other | zcx_other | isratnisa | zcx     |
|----------------------------|----------|------|-----------------|-----------|-----------------|-----------|-----------|---------|
| matrix_10000_10000_4000000 | 96.00%   | 2000 | 15.26           | 6.55      | 78.71           | 1018.56   | 93.97     | 1025.11 |
| matrix_10000_10000_4000000 | 96.00%   | 5000 | 41.42           | 19.60     | 78.19           | 1023.85   | 119.61    | 1043.45 |
| matrix_10000_10000_4000000 | 96.00%   | 4000 | 29.98           | 12.94     | 77.94           | 1026.02   | 107.92    | 1038.96 |
| matrix_10000_10000_4000000 | 96.00%   | 3000 | 22.97           | 11.61     | 80.38           | 1016.64   | 103.35    | 1028.25 |
| matrix_10000_10000_4000000 | 96.00%   | 1000 | 7.51            | 2.91      | 83.26           | 1027.88   | 90.77     | 1030.79 |
| matrix_10000_10000_4000000 | 96.00%   | 500  | 3.85            | 1.94      | 83.79           | 1015.33   | 87.64     | 1017.27 |
| matrix_10000_10000_4000000 | 96.00%   | 256  | 1.84            | 0.94      | 79.64           | 1013.16   | 81.48     | 1014.10 |NO PASS numError = 25

|                            | sparsity | k    | isratnisa_sddmm | zcx_sddmm | isratnisa_other | zcx_other | isratnisa | zcx    |
|----------------------------|----------|------|-----------------|-----------|-----------------|-----------|-----------|--------|
| matrix_10000_10000_3000000 | 97.00%   | 5000 | 32.44           | 19.12     | 60.93           | 772.70    | 93.37     | 791.81 |
| matrix_10000_10000_3000000 | 97.00%   | 4000 | 23.72           | 13.19     | 58.43           | 765.98    | 82.14     | 779.18 |
| matrix_10000_10000_3000000 | 97.00%   | 3000 | 18.17           | 11.65     | 58.82           | 772.37    | 77.00     | 784.03 |
| matrix_10000_10000_3000000 | 97.00%   | 2000 | 11.75           | 6.41      | 60.28           | 762.55    | 72.03     | 768.96 |
| matrix_10000_10000_3000000 | 97.00%   | 1000 | 5.72            | 2.88      | 66.71           | 770.15    | 72.43     | 773.03 |
| matrix_10000_10000_3000000 | 97.00%   | 500  | 2.91            | 1.76      | 53.63           | 771.30    | 56.55     | 773.05 |
| matrix_10000_10000_3000000 | 97.00%   | 256  | 1.40            | 0.92      | 59.01           | 775.42    | 60.41     | 776.34 |NO PASS numError = 28

|                            | sparsity | k    | isratnisa_sddmm | zcx_sddmm | isratnisa_other | zcx_other | isratnisa | zcx    |
|----------------------------|----------|------|-----------------|-----------|-----------------|-----------|-----------|--------|
| matrix_10000_10000_2000000 | 98.00%   | 256  | 0.99            | 0.90      | 44.09           | 513.74    | 45.08     | 514.64 |NO PASS numError = 13
| matrix_10000_10000_2000000 | 98.00%   | 500  | 2.01            | 1.74      | 33.12           | 518.23    | 35.13     | 519.97 |
| matrix_10000_10000_2000000 | 98.00%   | 1000 | 3.96            | 2.87      | 39.68           | 518.83    | 43.64     | 521.70 |
| matrix_10000_10000_2000000 | 98.00%   | 2000 | 8.26            | 6.39      | 40.36           | 518.41    | 48.62     | 524.80 |
| matrix_10000_10000_2000000 | 98.00%   | 3000 | 12.86           | 11.59     | 39.91           | 521.62    | 52.76     | 533.21 |
| matrix_10000_10000_2000000 | 98.00%   | 4000 | 16.77           | 13.30     | 39.36           | 514.80    | 56.13     | 528.10 |
| matrix_10000_10000_2000000 | 98.00%   | 5000 | 22.75           | 19.64     | 40.62           | 523.57    | 63.37     | 543.21 |

|                            | sparsity | k    | isratnisa_sddmm | zcx_sddmm | isratnisa_other | zcx_other | isratnisa | zcx    |
|----------------------------|----------|------|-----------------|-----------|-----------------|-----------|-----------|--------|
| matrix_10000_10000_1000000 | 99.00%   | 256  | 0.58            | 0.83      | 17.98           | 274.54    | 18.56     | 275.37 |NO PASS numError = 9
| matrix_10000_10000_1000000 | 99.00%   | 500  | 1.11            | 1.61      | 15.65           | 263.37    | 16.77     | 264.98 |
| matrix_10000_10000_1000000 | 99.00%   | 1000 | 2.18            | 2.44      | 19.98           | 272.76    | 22.16     | 275.20 |
| matrix_10000_10000_1000000 | 99.00%   | 2000 | 4.59            | 6.07      | 20.08           | 274.59    | 24.68     | 280.66 |
| matrix_10000_10000_1000000 | 99.00%   | 3000 | 7.15            | 11.07     | 19.47           | 270.33    | 26.63     | 281.40 |
| matrix_10000_10000_1000000 | 99.00%   | 4000 | 9.32            | 12.76     | 19.63           | 271.26    | 28.95     | 284.03 |
| matrix_10000_10000_1000000 | 99.00%   | 5000 | 12.50           | 19.06     | 19.91           | 268.83    | 32.41     | 287.90 |

---

##### 测试结果 32×8×16 行主序储存

###### matrix 10000 10000

- GPU : 4090
- Release build
- matrixA(half) : row_major, matrixB(half) : row_major, matrixP(float) : row_major
- WMMA : 32×8×16

|                            | sparsity | k    | isratnisa_sddmm | zcx_sddmm | isratnisa_other | zcx_other | isratnisa | zcx     |
|----------------------------|----------|------|-----------------|-----------|-----------------|-----------|-----------|---------|
| matrix_10000_10000_5000000 | 95.00%   | 256  | 2.23            | 1.39      | 83.31           | 1297.65   | 85.54     | 1299.04 |NO PASS numError = 39
| matrix_10000_10000_5000000 | 95.00%   | 500  | 4.95            | 2.70      | 76.96           | 1305.11   | 81.91     | 1307.81 |
| matrix_10000_10000_5000000 | 95.00%   | 1000 | 9.87            | 3.56      | 82.77           | 1308.19   | 92.64     | 1311.75 |
| matrix_10000_10000_5000000 | 95.00%   | 2000 | 19.56           | 7.86      | 83.37           | 1301.65   | 102.94    | 1309.51 |
| matrix_10000_10000_5000000 | 95.00%   | 3000 | 29.43           | 16.66     | 91.13           | 1309.54   | 120.57    | 1326.19 |
| matrix_10000_10000_5000000 | 95.00%   | 4000 | 36.49           | 15.93     | 83.38           | 1309.52   | 119.87    | 1325.45 |
| matrix_10000_10000_5000000 | 95.00%   | 5000 | 51.31           | 65.29     | 82.39           | 1301.58   | 133.71    | 1366.87 |

|                            | sparsity | k    | isratnisa_sddmm | zcx_sddmm | isratnisa_other | zcx_other | isratnisa | zcx     |
|----------------------------|----------|------|-----------------|-----------|-----------------|-----------|-----------|---------|
| matrix_10000_10000_4000000 | 96.00%   | 256  | 1.77            | 1.38      | 60.81           | 1036.66   | 62.58     | 1038.04 |NO PASS numError = 79
| matrix_10000_10000_4000000 | 96.00%   | 500  | 3.79            | 2.68      | 64.43           | 1041.87   | 68.22     | 1044.55 |
| matrix_10000_10000_4000000 | 96.00%   | 1000 | 7.45            | 3.52      | 62.84           | 1050.45   | 70.29     | 1053.97 |
| matrix_10000_10000_4000000 | 96.00%   | 2000 | 15.30           | 7.82      | 61.88           | 1047.14   | 77.17     | 1054.96 |
| matrix_10000_10000_4000000 | 96.00%   | 3000 | 23.06           | 16.65     | 60.90           | 1043.31   | 83.96     | 1059.96 |
| matrix_10000_10000_4000000 | 96.00%   | 4000 | 30.14           | 15.87     | 61.78           | 1044.76   | 91.92     | 1060.63 |
| matrix_10000_10000_4000000 | 96.00%   | 5000 | 41.52           | 69.48     | 62.11           | 1046.49   | 103.63    | 1115.97 |

|                            | sparsity | k    | isratnisa_sddmm | zcx_sddmm | isratnisa_other | zcx_other | isratnisa | zcx    |
|----------------------------|----------|------|-----------------|-----------|-----------------|-----------|-----------|--------|
| matrix_10000_10000_3000000 | 97.00%   | 256  | 10.12           | 1.36      | 47.29           | 796.36    | 57.41     | 797.73 |NO PASS numError = 45
| matrix_10000_10000_3000000 | 97.00%   | 500  | 2.88            | 2.67      | 38.38           | 785.58    | 41.26     | 788.25 |
| matrix_10000_10000_3000000 | 97.00%   | 1000 | 5.67            | 3.35      | 48.58           | 785.13    | 54.25     | 788.49 |
| matrix_10000_10000_3000000 | 97.00%   | 2000 | 11.75           | 7.91      | 49.27           | 781.59    | 61.02     | 789.50 |
| matrix_10000_10000_3000000 | 97.00%   | 3000 | 18.22           | 16.63     | 48.50           | 784.33    | 66.71     | 800.96 |
| matrix_10000_10000_3000000 | 97.00%   | 4000 | 23.69           | 16.09     | 47.92           | 781.94    | 71.60     | 798.04 |
| matrix_10000_10000_3000000 | 97.00%   | 5000 | 32.42           | 71.27     | 49.85           | 785.95    | 82.27     | 857.23 |

|                            | sparsity | k    | isratnisa_sddmm | zcx_sddmm | isratnisa_other | zcx_other | isratnisa | zcx    |
|----------------------------|----------|------|-----------------|-----------|-----------------|-----------|-----------|--------|
| matrix_10000_10000_2000000 | 98.00%   | 256  | 0.92            | 1.35      | 34.09           | 518.69    | 35.01     | 520.03 |NO PASS numError = 16
| matrix_10000_10000_2000000 | 98.00%   | 500  | 1.93            | 2.65      | 25.49           | 529.36    | 27.42     | 532.01 |
| matrix_10000_10000_2000000 | 98.00%   | 1000 | 3.91            | 3.32      | 31.39           | 527.49    | 35.30     | 530.81 |
| matrix_10000_10000_2000000 | 98.00%   | 2000 | 8.23            | 8.01      | 31.52           | 527.78    | 39.75     | 535.79 |
| matrix_10000_10000_2000000 | 98.00%   | 3000 | 12.87           | 16.53     | 30.85           | 528.26    | 43.72     | 544.79 |
| matrix_10000_10000_2000000 | 98.00%   | 4000 | 16.74           | 51.44     | 30.95           | 526.59    | 47.69     | 578.03 |
| matrix_10000_10000_2000000 | 98.00%   | 5000 | 22.77           | 71.34     | 30.92           | 530.98    | 53.68     | 602.32 |

|                            | sparsity | k    | isratnisa_sddmm | zcx_sddmm | isratnisa_other | zcx_other | isratnisa | zcx    |
|----------------------------|----------|------|-----------------|-----------|-----------------|-----------|-----------|--------|
| matrix_10000_10000_1000000 | 99.00%   | 256  | 0.50            | 1.25      | 14.86           | 259.32    | 15.36     | 260.57 |NO PASS numError = 12
| matrix_10000_10000_1000000 | 99.00%   | 500  | 1.03            | 2.49      | 13.37           | 259.63    | 14.40     | 262.12 |
| matrix_10000_10000_1000000 | 99.00%   | 1000 | 2.12            | 3.05      | 18.03           | 267.07    | 20.15     | 270.13 |
| matrix_10000_10000_1000000 | 99.00%   | 2000 | 4.54            | 12.74     | 17.27           | 269.68    | 21.81     | 282.43 |
| matrix_10000_10000_1000000 | 99.00%   | 3000 | 7.08            | 14.79     | 17.55           | 269.74    | 24.62     | 284.52 |
| matrix_10000_10000_1000000 | 99.00%   | 4000 | 9.28            | 50.82     | 17.41           | 267.94    | 26.69     | 318.76 |
| matrix_10000_10000_1000000 | 99.00%   | 5000 | 12.45           | 67.96     | 17.51           | 272.74    | 29.96     | 340.70 |

---

##### 测试结果 16×32×16 行主序储存

###### matrix 10000 10000

- GPU : 4090
- Release build
- matrixA(half) : row_major, matrixB(half) : row_major, matrixP(float) : row_major
- WMMA : 16×32×16

|                            | sparsity | k    | isratnisa_sddmm | zcx_sddmm | isratnisa_other | zcx_other | isratnisa | zcx     |
|----------------------------|----------|------|-----------------|-----------|-----------------|-----------|-----------|---------|
| matrix_10000_10000_5000000 | 95.00%   | 256  | 2.23            | 1.25      | 85.47           | 1297.56   | 87.70     | 1298.81 |NO PASS numError = 38
| matrix_10000_10000_5000000 | 95.00%   | 500  | 4.94            | 2.39      | 79.19           | 1310.15   | 84.13     | 1312.54 |
| matrix_10000_10000_5000000 | 95.00%   | 1000 | 9.89            | 4.15      | 84.17           | 1305.81   | 94.05     | 1309.96 |
| matrix_10000_10000_5000000 | 95.00%   | 2000 | 19.57           | 8.39      | 83.06           | 1308.23   | 102.63    | 1316.63 |
| matrix_10000_10000_5000000 | 95.00%   | 3000 | 29.42           | 14.97     | 85.95           | 1303.01   | 115.36    | 1317.98 |
| matrix_10000_10000_5000000 | 95.00%   | 4000 | 36.99           | 18.61     | 82.49           | 1308.93   | 119.48    | 1327.53 |
| matrix_10000_10000_5000000 | 95.00%   | 5000 | 51.57           | 24.07     | 85.27           | 1310.29   | 136.84    | 1334.36 |

|                            | sparsity | k    | isratnisa_sddmm | zcx_sddmm | isratnisa_other | zcx_other | isratnisa | zcx     |
|----------------------------|----------|------|-----------------|-----------|-----------------|-----------|-----------|---------|
| matrix_10000_10000_4000000 | 96.00%   | 256  | 1.76            | 1.23      | 62.79           | 1038.22   | 64.55     | 1039.45 |NO PASS numError = 29
| matrix_10000_10000_4000000 | 96.00%   | 500  | 3.79            | 2.36      | 67.16           | 1049.62   | 70.95     | 1051.99 |
| matrix_10000_10000_4000000 | 96.00%   | 1000 | 7.45            | 4.14      | 63.65           | 1051.93   | 71.10     | 1056.07 |
| matrix_10000_10000_4000000 | 96.00%   | 2000 | 15.27           | 8.37      | 62.22           | 1049.78   | 77.50     | 1058.15 |
| matrix_10000_10000_4000000 | 96.00%   | 3000 | 23.09           | 15.09     | 61.76           | 1042.74   | 84.85     | 1057.83 |
| matrix_10000_10000_4000000 | 96.00%   | 4000 | 29.98           | 18.57     | 61.91           | 1044.47   | 91.89     | 1063.04 |
| matrix_10000_10000_4000000 | 96.00%   | 5000 | 41.57           | 24.05     | 61.64           | 1049.89   | 103.21    | 1073.94 |

|                            | sparsity | k    | isratnisa_sddmm | zcx_sddmm | isratnisa_other | zcx_other | isratnisa | zcx    |
|----------------------------|----------|------|-----------------|-----------|-----------------|-----------|-----------|--------|
| matrix_10000_10000_3000000 | 97.00%   | 256  | 1.34            | 1.21      | 49.80           | 786.83    | 51.14     | 788.03 |NO PASS numError = 20
| matrix_10000_10000_3000000 | 97.00%   | 500  | 2.86            | 2.35      | 38.38           | 792.08    | 41.25     | 794.43 |
| matrix_10000_10000_3000000 | 97.00%   | 1000 | 5.67            | 3.93      | 50.79           | 788.73    | 56.46     | 792.66 |
| matrix_10000_10000_3000000 | 97.00%   | 2000 | 11.75           | 8.36      | 48.96           | 787.84    | 60.70     | 796.20 |
| matrix_10000_10000_3000000 | 97.00%   | 3000 | 18.18           | 15.00     | 49.63           | 792.15    | 67.81     | 807.16 |
| matrix_10000_10000_3000000 | 97.00%   | 4000 | 23.73           | 18.63     | 47.69           | 791.03    | 71.42     | 809.67 |
| matrix_10000_10000_3000000 | 97.00%   | 5000 | 32.46           | 23.26     | 50.11           | 784.31    | 82.57     | 807.57 |

|                            | sparsity | k    | isratnisa_sddmm | zcx_sddmm | isratnisa_other | zcx_other | isratnisa | zcx    |
|----------------------------|----------|------|-----------------|-----------|-----------------|-----------|-----------|--------|
| matrix_10000_10000_2000000 | 98.00%   | 256  | 0.92            | 1.18      | 33.96           | 518.80    | 34.88     | 519.98 |NO PASS numError = 42
| matrix_10000_10000_2000000 | 98.00%   | 500  | 1.93            | 2.33      | 25.37           | 526.06    | 27.30     | 528.39 |
| matrix_10000_10000_2000000 | 98.00%   | 1000 | 3.89            | 3.91      | 30.87           | 529.02    | 34.77     | 532.93 |
| matrix_10000_10000_2000000 | 98.00%   | 2000 | 8.22            | 8.29      | 31.97           | 524.69    | 40.19     | 532.99 |
| matrix_10000_10000_2000000 | 98.00%   | 3000 | 12.81           | 14.95     | 31.20           | 524.95    | 44.00     | 539.89 |
| matrix_10000_10000_2000000 | 98.00%   | 4000 | 16.73           | 18.52     | 31.46           | 533.88    | 48.19     | 552.40 |
| matrix_10000_10000_2000000 | 98.00%   | 5000 | 22.68           | 24.56     | 31.43           | 527.96    | 54.11     | 552.52 |

|                            | sparsity | k    | isratnisa_sddmm | zcx_sddmm | isratnisa_other | zcx_other | isratnisa | zcx    |
|----------------------------|----------|------|-----------------|-----------|-----------------|-----------|-----------|--------|
| matrix_10000_10000_1000000 | 99.00%   | 256  | 0.48            | 1.09      | 15.17           | 259.64    | 15.65     | 260.73 |NO PASS numError = 7
| matrix_10000_10000_1000000 | 99.00%   | 500  | 1.04            | 2.16      | 13.21           | 269.62    | 14.25     | 271.78 |
| matrix_10000_10000_1000000 | 99.00%   | 1000 | 2.12            | 3.63      | 17.64           | 268.83    | 19.76     | 272.45 |
| matrix_10000_10000_1000000 | 99.00%   | 2000 | 4.54            | 7.39      | 17.69           | 268.60    | 22.24     | 275.99 |
| matrix_10000_10000_1000000 | 99.00%   | 3000 | 7.10            | 13.88     | 17.69           | 266.79    | 24.79     | 280.67 |
| matrix_10000_10000_1000000 | 99.00%   | 4000 | 9.27            | 17.49     | 17.60           | 273.91    | 26.87     | 291.40 |
| matrix_10000_10000_1000000 | 99.00%   | 5000 | 11.85           | 25.79     | 17.99           | 269.68    | 29.84     | 295.47 |

---

#### 使用共享内存: 分割处理

##### 测试结果 行主序储存 16×16×16

- GPU : 4090
- Release build
- matrixA(half) : row_major, matrixB(half) : row_major, matrixP(float) : row_major
- WMMA : 16 × 16 × 16

---