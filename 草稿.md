# SDDMM

---

## Implementation

在本节中,

### row reorder

为了生成更多的高密度块, 需要识别矩阵的块级稀疏模式, 将具有相同块稀疏模式的行排列在一起.

---

### col reorder

首先将重排序后的行分为大小为16的行面板, 行面板的大小设置为16的理由是为了最终形成多个16×16的块,
以匹配WMMA API中tf32的矩阵乘法操作的输入维度.
计算每个行面板中每个列段的非零元素数量然后根据非零元素数量按降序排序, 将非零元素数量为0的列索引在排序前去除可以有效减少排序的时间复杂度. 
规定一个稀疏阈值(), 将非零元素数量大于等于阈值()的列索引归类为稠密列, 小于阈值()的列索引归类为稀疏列. 
各个行面板中的稠密列排列在一起组成了dense tiled, 稀疏列排列在一起组成了sparse tiled.

阈值()的选择

---

### 稠密块和稀疏块的储存

Dense tiled中按照

---

### SDDMM dense block

算法1中描述了使用Tensor core加速的SDDMM算法. 

---

### SDDMM sparse block

---